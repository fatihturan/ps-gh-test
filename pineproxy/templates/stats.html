{% load static %}
{% load my_tags %}
{% load random_numbers %}

<!DOCTYPE html>
<html lang="en" data-textdirection="ltr" class="loading">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>-->
    <!-- <link rel="preload" href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i%7COpen+Sans:300,300i,400,400i,600,600i,700,700i" as="style"> -->
    <!-- <link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i%7COpen+Sans:300,300i,400,400i,600,600i,700,700i" rel="stylesheet" media="screen" onload="this.media='all'"> -->
    <!-- BEGIN VENDOR CSS-->
    <link rel="preload" href="{% static 'app-assets/css/bootstrap.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/bootstrap.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'app-assets/fonts/feather/style.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/feather/style.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'app-assets/fonts/font-awesome/css/font-awesome.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/font-awesome/css/font-awesome.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'app-assets/css/bootstrap-extended.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/bootstrap-extended.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'app-assets/css/app.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/app.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'app-assets/css/colors.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/colors.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'app-assets/css/core/menu/menu-types/horizontal-menu.min.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/core/menu/menu-types/horizontal-menu.min.css' %}" onload="this.media='all'">
    <link rel="preload" href="{% static 'assets/css/style.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}" onload="this.media='all'">

    <!-- START Custom CSS-->
    <link rel="preload" href="{% static 'css/custom-stories.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'css/custom-stories.css' %}" media="screen" onload="this.media='all'">
    <link rel="preload" href="{% static 'blog/main.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'blog/main.css' %}" media="screen" onload="this.media='all'">
    <link rel="preload" href="{% static 'blog/style.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'blog/style.css' %}" media="screen" onload="this.media='all'">
    <link rel="preload" href="{% static 'blog/new-style-2022-05-02.css' %}" as="style">
    <link rel="stylesheet" type="text/css" href="{% static 'blog/new-style-2022-05-02.css' %}" media="screen" onload="this.media='all'">

    <!-- END Custom CSS-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" media="screen" onload="this.media='all'">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700;800&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700;800&display=swap" rel="stylesheet" media="screen" onload="this.media='all'">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet" media="screen" onload="this.media='all'">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@200;300;400;500;600;700&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@200;300;400;500;600;700&display=swap" rel="stylesheet" media="screen" onload="this.media='all'">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MVXEN40PGH"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-185900750-1">
    </script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-185900750-1');
    </script>

    <!-- Choice Boxes -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.css">
    <!-- <script src="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.js"></script> -->
    <script src="{% static 'blog/js/choices.min.js' %}" type="text/javascript"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-MVXEN40PGH');
    </script>

    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '137862831678866');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=137862831678866&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->

</head>

<style>

    body, html {width: 100%; height: 100%; margin: 0; padding: 0}

    strong{
        color:inherit;
    }

    .search-props{
        color: #274970!important;
        font-weight: 500;
        border: 1px solid #274970;
        padding-left: 22px;
        padding-right: 20px;
        padding-top: 8px;
        padding-bottom: 8px;
        border-radius: 20px;
        display: inline-block;
    }

    .search-props:hover{
        background-color: #edf2f9!important;
    }
    .dtale-link{
        font-size:16px !important;
        color: #black!important;
        font-family: 'Roboto' !important
    }

    .dtale-link-selected{
        font-size:18px !important;
        color:#4EC48F !important
        font-family: 'Roboto' !important
    }
    .dtale-link:hover{
        color:#4EC48F !important;
        font-weight:500!important;
    }

    .dtale-link-icon{
        margin-right:10px;
        width:30px
    }

    /* Flex options allow for iFrame to auto adjust to browswer window.
    Pine container includes sticky container and dtale iframe container
    Sticky container is fixed
    Dtale iframe container is flex-grow */

    .pine-container{
        display: flex;
        width: 100%;
        height: 100%;
        flex-direction: column;
    }

    .sticky-container{
        background-color: white !important;
    }

    .dtale-iframe{
        background-color: white !important;
        background: url("{% static 'images/Spin1_Gray.svg' %}") 50% 10% no-repeat;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        border: none;
        margin: 0;
        padding: 0;
        position: relative;
        height:100%;
    }

    /*css for hiding explore if height is too small */
    @media screen and (max-height: 500px) {
        .hidden-small-height{
            display: none;
        }
    }

    .chart-link{
        cursor: pointer;
        line-height:30px!important;
        width:290px;
        margin-bottom:9px;
        font-family: 'Roboto'!important;
        font-weight: 400!important;
        font-size:13px!important;
        background-color: #F0FAF626!important;
        color: #284970!important;
        border-width:1px!important;
        /* box-shadow: 0.25px 0.25px 1px 0.5px #28497036; */
        border-radius:25px;
        border-color:#65cd99;
        border-style: solid;
    }
    .chart-link:hover{
        font-weight:500!important;
        color:#4EC48F!important;
    }
    .chart-link:active{
        background-color:#F0FAF6!important;
    }

    .compare-link{
        cursor: pointer;
        line-height:42px!important;
        width:311px;
        margin-top:10px;
        margin-bottom:5px;
        font-family: 'Roboto'!important;
        font-weight: 400!important;
        font-size:17px!important;
        background-color: #F0FAF626!important;
        color: #284970!important;
        border-width:1px!important;
        /* box-shadow: 0.25px 0.25px 1px 0.5px #28497036; */
        border-radius:25px;
        border-color: #284970;
        border-style: solid;
        padding-top:2px;
        padding-bottom:2px;
    }
    .compare-link:hover{
        font-weight:500!important;
        background-color: #edf2f9!important;
    }

    .compare-link-mobile{
        cursor: pointer;
        line-height:42px!important;
        width:290px;
        margin-bottom:30px;
        font-family: 'Roboto'!important;
        font-weight: 300!important;
        font-size:18px!important;
        background-color: #F0FAF626!important;
        color: #274970!important;
        border-width:1px!important;
        /* box-shadow: 0.25px 0.25px 1px 0.5px #28497036; */
        border-radius:25px;
        border-color: #274970;
        border-style: solid;
    }
    .compare-link-mobile:hover{
        font-weight:400!important;
        color:#274970!important;
        background-color: #edf2f9!important;
    }

    .compare-link-mobile:active{
        background-color: #edf2f9!important;
    }

    .csv-link{
        {% if is_group %}
        cursor: pointer;
        background-color: #f6f7fa!important;
        font-weight:400!important;
        font-size:26px!important;
        color:#284970!important;
        border: 1px solid #eee;
        {% else %}
        border: 0px;
        background-color: white;
        font-weight:500!important;
        font-size:28px!important;
        color:#4EC48F!important;
        border-width:0px!important;
        {% endif %}
        font-family:'Roboto'!important;
        width:90%;
        border-radius:25px;
        line-height:60px!important;
    }

    {% if is_group %}
    .csv-link:hover{
        font-weight:500!important;
        background-color:#e9ecf3!important;
    }
    {% endif %}

    .explore-home-table{

        box-shadow: 1px 1px 1.5px 1.5px gray;
        border-radius: 1px;
        padding-left: 15px;
        padding-right: 15px;
        padding-top: 30px;
        padding-bottom: 45px;
    }

     @media screen and (max-width: 820px) {
         .header-navbar .navbar-nav .open {
	             position:relative;
         }
     }
    .white-bg:hover{
        background-color:#f0faf5!important;
    }

    @media screen and (max-width: 378px) {
        .hidden-narrow{
            display:none;
         }
    }

</style>
{% include "blog/darkmode.html" %}
{# <div>{% include "banner.html" %}</div> #}
<body data-open="click" data-menu="horizontal-menu" data-col="2-columns" class="horizontal-layout horizontal-menu 2-columns">
<!-- navbar-fixed-top-->
<div id="pine-container" class="pine-container">
    <div class="sticky-container">
        <nav class="header-navbar navbar navbar-with-menu navbar-static-top navbar-light navbar-border navbar-brand-left navbar-fixed top-navb" style="background-color:#efbfcfd">
            <div class="navbar-wrapper container-fluid" style="margin-bottom:5px">
                <ul class="navbar-container" style="">
                    <div>
                        <a href="/" class="navbar-brand"><img alt="Pine" src="{% static 'images/PineSportsLogoSmall.svg' %}" style="height:46px;margin-right:-15px" class="brand-logo"></a>
                    </div>
                    {% if user.is_authenticated %}
                    <div class="nav navbar-nav float-xs-right admin" style="">
                        <div class="dropdown dropdown-notification nav-item hidden-sm-down"><a onclick="getHome()"><img src="{% static 'images/black-home-feed.svg'%}" title="Home" class="img-responsive mr-1 mt-1" style=""></img></a></div>

                        {%if notification_count > 0 %}
                        <div class="dropdown dropdown-user nav-item hidden-sm-down"><a href="/notifications/" data-toggle="dropdown" class="nav-link dropdown-user-link" style="margin-left:-3px;">
                            <span class="img-responsive mr-1 mt-1"><img name="notifications" src="{% static 'images/black-notifications.svg'%}" style="margin-top:0px!important;width:34px!important"></span>
                            <div class="dropdown-menu dropdown-menu-right">
                                {% for notification in recent_notifications %}
                                {% if notification.is_seen %}
                                <div class="row" style="margin-left:0px;margin-right:0px;padding: 10px 15px;">
                                    {% else %}
                                    <div class="row" style="background-color:#f0faf5; margin-left:0px;margin-right:0px;padding: 10px 15px;">
                                        {% endif %}
                                        {% if notification.Notification_type == 1 %}
                                        <div class="dropdown-item white-bg" style="padding-right:120px; margin-right:-15px; margin-left:-15px; {%if forloop.counter == 1%} margin-top:-30px;{%else%}margin-top:-20px;{%endif%}">
                                            <span class="pine-avatar" style="width:30px!important; float:left;margin-right:10px;margin-bottom:10px">
                                                <img src="{{notification.sender.profile.optimized_image_url}}"  onError='this.onerror=null;this.src="{% static "images/profile.svg" %}?v=2";'  style="width:30px!important; height:30px!important; margin-top:1px!important" alt="avatar">
                                            </span>
                                            <a style="color:#4EC48F; font-weight:600" href="{% url 'stories:user-posts' username=notification.sender.username %}">{{notification.sender.username}}</a> {% if notification.count > 9 %} and {{notification.count|safe}} other people {% endif %}
                                            liked your <span style="font-weight:600"><a style="color:#274970" href="{% url 'stories:post-detail' notification.post.id notification.post.slug %}">post.</a></span><br>
                                            <small>{{ notification.date | timesince | upto:','  }} ago</small>
                                        </div>
                                        {% endif %}

                                        {% if notification.Notification_type == 2 %}
                                        <div class="dropdown-item white-bg" style="padding-right:120px; margin-right:-15px; margin-left:-15px; {%if forloop.counter == 1%} margin-top:-30px;{%else%}margin-top:-20px;{%endif%}">
                                            <span class="pine-avatar" style="width:30px!important; float:left;margin-right:10px;margin-bottom:10px">
                                                <img src="{{notification.sender.profile.optimized_image_url}}"  onError='this.onerror=null;this.src="{% static "images/profile.svg" %}?v=2";'  style="width:30px!important; height:30px!important; margin-top:1px!important" alt="avatar">
                                            </span>
                                            <a style="color:#4EC48F; font-weight:600" href="{% url 'stories:user-posts' username=notification.sender.username %}">{{notification.sender.username}}</a>
                                            commented on your <span style="font-weight:600"><a style="color:#274970" href="{% url 'stories:post-detail' notification.post.id notification.post.slug %}">post.</a></span><br>
                                            <small>{{ notification.date | timesince | upto:','  }} ago</small>
                                        </div>
                                        {% endif %}

                                        {% if notification.Notification_type == 3 %}
                                        <div class="dropdown-item white-bg" style="padding-right:120px; margin-right:-15px; margin-left:-15px; {%if forloop.counter == 1%} margin-top:-30px;{%else%}margin-top:-20px;{%endif%}">
                                            <span class="pine-avatar" style="width:30px!important; float:left;margin-right:10px;margin-bottom:10px">
                                                <img src="{{notification.sender.profile.optimized_image_url}}"  onError='this.onerror=null;this.src="{% static "images/profile.svg" %}?v=2";'  style="width:30px!important; height:30px!important; margin-top:1px!important" alt="avatar">
                                            </span>
                                            <a style="color:#4EC48F; font-weight:600" href="{% url 'stories:user-posts' username=notification.sender.username %}">{{notification.sender.username}}</a>
                                            also commented on a <span style="font-weight:600"><a style="color:#274970" href="{% url 'stories:post-detail' notification.post.id notification.post.slug %}">post.</a></span><br>
                                            <small>{{ notification.date | timesince | upto:','  }} ago</small>
                                        </div>
                                        {% endif %}

                                        {% if notification.Notification_type == 4 %}
                                        <div class="dropdown-item white-bg" style="padding-right:120px; margin-right:-15px; margin-left:-15px; {%if forloop.counter == 1%} margin-top:-30px;{%else%}margin-top:-20px;{%endif%}">
                                            <span class="pine-avatar" style="width:30px!important; float:left;margin-right:10px;margin-bottom:10px">
                                                <img src="{{notification.sender.profile.optimized_image_url}}"  onError='this.onerror=null;this.src="{% static "images/profile.svg" %}?v=2";'  style="width:30px!important; height:30px!important; margin-top:1px!important" alt="avatar">
                                            </span>
                                            <a style="color:#4EC48F; font-weight:600" href="{% url 'stories:user-posts' username=notification.sender.username %}">{{notification.sender.username}}</a>{% if notification.count > 9 %} and {{notification.count|safe}} other people {% endif %}
                                            liked your <span style="font-weight:600"><a style="color:#274970" href="{% url 'stories:post-detail' notification.post.id notification.post.slug %}">comment</a></span><br>
                                            <small>{{ notification.date | timesince | upto:','  }} ago</small>
                                        </div>
                                        {% endif %}

                                        {% if notification.Notification_type == 5 %}
                                        <div class="dropdown-item white-bg" style="padding-right:120px; margin-right:-15px; margin-left:-15px; {%if forloop.counter == 1%} margin-top:-30px;{%else%}margin-top:-20px;{%endif%}">
                                            You have one new invite!  Who's a great potential addition to Pine Sports? The invite code is <i><b> &nbsp;{{ notification.text_preview }}</b></i> <b><a href="{% url 'user_beta_notification' %}" target="_blank" class="text-primary"> Click here</a></b> to send this invite code to your friend.
                                            <br><small>{{ notification.date | timesince | upto:','  }} ago</small>
                                        </div>
                                        {% endif %}
                                    </div>
                                    {% endfor %}
                                    <a style="font-family: 'Raleway'!important; font-weight: 600!important; font-size: 14px; color: #274970!important;margin-top:0px;" class="dropdown-item" href="/notifications/">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More...</a>
                                </div>
                            </div>
                            {% endif %}

                            <div class="hidden-md-up dropdown dropdown-user nav-item" style="margin-right: 7px;">
                                <a href="" data-toggle="dropdown" class="nav-link" aria-haspopup="true" aria-expanded="false">
                                    <span class="img-responsive"><img src="{% static 'images/black-explore.svg'%}"></span>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    {% for sport in sports_name %}
                                    {% if sport != "NFL-CBS" %}
                                    <a class="dropdown-item" style="font-family: 'Raleway'; font-size: 14px" href="{% url 'stats_generating' sport_name=sport %}">{{sport}}</a>
                                    {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="hidden-md-up dropdown dropdown-user nav-item" style="margin-right: 7px;">
                                <a href="" data-toggle="dropdown" class="nav-link" aria-haspopup="true" aria-expanded="false">
                                    <span class="img-responsive"><img src="{% static 'images/black-predict.svg'%}"></span>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    {% for sport in sports_name %}
                                    <a class="dropdown-item" style="font-family: 'Raleway'; font-size: 14px" href="{% url 'predict' sport_name=sport %}">{{sport}}</a>
                                    {% endfor %}
                                </div>
                            </div>

                            {%if notification_count > 0 %}
                            <div class="dropdown dropdown-notification nav-item hidden-md-up">
                                <a href="/notifications/" style="margin-right:-7px"><img name="notifications" src="{% static 'images/black-notifications.svg'%}" title="Notifications" class="img-responsive mr-1 mt-1" style=""></img></a>
                            </div>
                            {% endif %}

                            <div class="dropdown dropdown-notification nav-item hidden-sm-down"><a href="{% url 'stories:post-create' %}"><img src="{% static 'images/black-write-circle.svg'%}" title="New Post" class="img-responsive mr-1 mt-1" style=""></img></a></div>

                            <!--<div class="dropdown dropdown-notification nav-item hidden-md-up"><a href="/"><img src="{% static 'images/black-home-feed.svg'%}" title="Home" class="img-responsive mt-1" style="margin-right:4px"></img></a></div>-->
                            <!--<div class="dropdown dropdown-notification nav-item hidden-md-up"><a href="{% url 'stories:post-create' %}"><img src="{% static 'images/black-write-circle.svg'%}" title="New Post" class="img-responsive mt-1" style="margin-right:6px"></img></a></div>-->



                            <div class="dropdown dropdown-user nav-item"><a href="/user/{{user}}" data-toggle="dropdown" class="dropdown-toggle nav-link dropdown-user-link">
                                <span class="pine-avatar"><img src="{{request.user.profile.optimized_image_url}}" onError='this.onerror=null;this.src="{% static "images/profile.svg" %}?v=2";' style="margin-top:1px!important" alt="avatar"><i></i></span><span class="hidden-md-down" style="font-family: 'Raleway'!important; font-weight: 500!important; font-size: 18px; color:rgba(0,0,0,.7)!important; margin-left:8px">{{user}}</span></a>
                                <div class="dropdown-menu dropdown-menu-right">

                                    <a style="font-family: 'Raleway'!important; font-weight: 400!important; font-size: 14px; color: #404E67!important;" class="dropdown-item hidden-md-up" href="{% url 'stories:post-create' %}"><img style="margin-right:5px" class="d-icon" src="{% static 'images/black-write-circle.svg'%}">  New Story</a>
                                    <a style="font-family: 'Raleway'!important; font-weight: 400!important; font-size: 14px; color: #404E67!important;" class="dropdown-item" href="/user/{{user}}"><img style="margin-right:5px" class="d-icon" src="{% static 'images/black-my-stories.svg'%}">  My Stories</a>
                                    <a style="font-family: 'Raleway'!important; font-weight: 400!important; font-size: 14px; color: #404E67!important;" class="dropdown-item" href="/user/{{user}}/drafts/"><img style="margin-right:5px" class="d-icon" src="{% static 'images/black-my-drafts.svg'%}">  My Drafts</a>
                                    <a style="font-family: 'Raleway'!important; font-weight: 400!important; font-size: 14px; color: #404E67!important;" class="dropdown-item" href="{% url 'help' %}"><img style="margin-right:5px" class="d-icon" src="{% static 'images/black-help.svg'%}">  Help</a>

                                    <a style="font-family: 'Raleway'!important; font-weight: 400!important; font-size: 14px; color: #404E67!important;" class="dropdown-item" href="{% url 'settings' %}"><img style="margin-right:5px" class="d-icon" src="{% static 'images/black-settings.svg'%}">  Settings</a>
                                    <a style="font-family: 'Raleway'!important; font-weight: 400!important; font-size: 14px; color: #404E67!important;" class="dropdown-item" href="/logout/"><img style="margin-right:5px" class="d-icon" src="{% static 'images/black-logout.svg'%}">  Logout</a>
                                </div>
                            </div>
                        </div>

                        {% else %}

                        <ul class="nav navbar-nav float-xs-right admin" style="">

                            <li class="dropdown dropdown-user nav-item"><a href="/login" data-toggle="dropdown" class="dropdown-toggle nav-link dropdown-user-link">
                                <span class="avatar"><img src="{% static 'images/profile.svg'%}" alt="avatar"></span></a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="/login"><img class="d-icon" src="{% static 'images/black-login.svg'%}"> Log In</a>
                                </div>
                            </li>

                        </ul>
                        {% endif %}

                    </div>
                    {% if user.is_authenticated %}
                    <!-- Horizontal navigation-->
                    <div role="navigation" data-menu="menu-wrapper" class="darkmode-flip hidden-sm-down hidden-small-height navbar-container main-menu-content container-fluid" id="" style="z-index: 0;background-color: #274970;">
                        <!-- include includes/mixins-->
                        <ul id="main-menu-navigation" data-menu="menu-navigation" class="nav navbar-nav" >
                            <!--Added this so that Stories lines up with Pine logo -->
                            <li>     </li>

                            <li class="nav-item hidden-sm-down">
                                {% if user.is_authenticated %}
                                <a href="{% url 'stories:blog-home' %}" class="nav-link" style="font-family: 'Raleway'; font-size: 25px">Stories</a>
                                {% else %}
                                <!--This is a hack to get the blue bar to stay when user is not logged in or authorized to see Explore -->
                                <a class="nav-link" style="font-family: 'Roboto'; min-height:45px"> </a>
                                {% endif %}
                            </li>
                            <li class="nav-item active hidden-sm-down">
                                {% if user.is_authenticated %}
                                <!--Sports Dropdown-->
                            <li class="nav-item active dropdown">
                                <a class="nav-link" style="font-family: 'Raleway'; font-weight: 500; font-size: 25px; color: #4EC48F;" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Explore
                                </a>
                                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    {% for sport in sports_name %}
                                    {% if sport != "NFL-CBS" %}
                                    <a class="dropdown-item" href="{% url 'stats_generating' sport_name=sport %}" style="font-family: 'Raleway'; font-size: 18px">{{sport}}</a>
                                    {% endif %}
                                    {% endfor %}
                                </div>
                            </li> <!--End of Sports Dropdown-->
                            <!--Predict Dropdown-->
                            <li class="nav-item dropdown">
                                <a class="nav-link" style="font-family: 'Raleway'; font-size: 25px" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Predict
                                </a>
                                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    {% for sport in sports_name %}
                                    <a class="dropdown-item" style="font-family: 'Raleway'; font-size: 18px" href="{% url 'predict' sport_name=sport %}">{{sport}}</a>
                                    {% endfor %}
                                </div>
                            </li>
                            <!--End of Predict Dropdown-->
                            {% endif %}
                            </li>
                        </ul>
                    </div>
                    <!-- Horizontal navigation-->

                    <!-- Spreadsheet Menu-->
                    <div id="spreadsheet-menu" data-menu="menu-container2" class="hidden-sm-down hidden-small-height navbar-container main-menu-content container-fluid center-layout" style="min-width:767px!important;display:none">
                        <div class="row" style="width:100%">
                            <div class="col-xs-1" style="max-width:10px"></div>
                            <div class="col-xs-1" style="margin-top:5px; min-width:120px; max-width:120px">
                                <a onclick="getView()" class="nav-link dtale-link" id="View" ><img src="{% static 'images/view.svg'%}?v=1" class="dtale-link-icon" title="View" class="img-responsive">View</a>
                            </div>
                            <div class="col-xs-1" style="margin-top:5px; min-width:140px; max-width:140px">
                                <a onclick="getCharts()" class="nav-link dtale-link" id="Vizualize"><img src="{% static 'images/visualize.svg'%}?v=1" class="dtale-link-icon" title="Vizualize" class="img-responsive">Visualize</a>
                            </div>
                            <div class="col-xs-1" style="margin-top:5px; min-width:140px; max-width:140px">
                                <a onclick="getCorrelations()" class="nav-link dtale-link" id="Correlate"><img src="{% static 'images/correlate.svg'%}?v=1" class="dtale-link-icon" title="Correlate" class="img-responsive">Correlate</a>
                            </div>
                            <div class="col-xs-1" style="margin-top:5px; min-width:115px; max-width:140px">
                                <a onclick="getSelect()" class="nav-link dtale-link" id="Select"><img src="{% static 'images/select.svg'%}?v=1" class="dtale-link-icon" title="Select" class="img-responsive">Select</a>
                            </div>
                            <!--- <div class="col-xs-1" style="margin-top:5px; min-width:115px; max-width:140px">
                                <a id="save_id" href="/" class="nav-link dtale-link" id="Select">Save</a>
                            </div> -->
                            <div class="pull-right" style="margin-top:1px">
                                <a onclick="getHome()" class="nav-link dtale-link" id="Back"><img src="{% static 'images/back.svg'%}" style="width:28px; margin-right:12px" title="Back Image" class="img-responsive"><span style="padding-top:5px;display:inline-block">Back to Dashboard</span></a>
                            </div>
                        </div>
                    </div>

                    {% endif %}
        </nav>

    </div>

    <style>
        .post-title-detail{
            font-family: 'Raleway', sans-serif;
            font-weight: 700;
            font-size: 85px!important;
            text-align: center;
            margin-top:20px!important;
            line-height: 55px!important;
            color: #284970;
            }
        h20{
            font-family: 'Raleway', sans-serif;
            font-size:14px;
            font-weight: 700;
            color: #284970;
            }
        h21{
            font-family: 'Raleway', sans-serif;
            font-size:18px;
            font-weight: 600;
            color: #284970;
            }
        h19{
            font-family: 'Raleway', sans-serif;
            font-weight:700;
            font-size: 30px;
            text-decoration: underline;
            color: #284970;
            border-radius: 3px;
            padding: 5px;
            padding-left:15px;
            padding-right:15px;
            }
        h18{
            font-family: 'Raleway', sans-serif;
            font-size:17px;
            font-weight: 500;
            color: #f0f2f5;
            }
        h18:hover{
            color:#274970;}
        h17{
            font-family: 'Raleway', sans-serif;
            color: #000;
            font-weight:400;
            font-size: 14px;
            border-radius: 2px;
            padding: 5px;
            margin-left:5%;
            opacity: .975;
            text-decoration: underline;
            }
        h17:hover{
            color:#4EC48F;
            }
        h19:hover{
           color: #4EC48F;
            }

        .explore-home-table-1, .explore-home-table-2, .explore-home-table-3, .explore-home-table-4{
            background: #ffffff;
            border:1px solid #eee;
            font-family: 'Raleway', sans-serif;
            font-weight: 500;
            padding: 10px;
            float: left;
            width: 48%;
            min-height:340px;
            margin:1%;
            }

        {% if is_group %}
        .explore-home-table-1:hover{
            background: #fbfcfd;
        }
        .explore-home-table-2:hover{
            background: #fbfcfd;
        }
        .explore-home-table-3:hover{
            background: #fbfcfd;
        }
        .explore-home-table-4:hover{
            background: #fbfcfd;
        }
        {% endif %}

        .all-content{
         width: 100%;
         overflow: hidden;
         position: relative;
         left: 0%;
        }
        a{
            color:#274970;
            }
        a:hover{
            color:#4EC48F;
            }
        .explain{
           font-family: 'Roboto', sans-serif;
            font-size:14px;
            font-weight: 400;
            color: rgba(0,0,0,.7);
            padding-left:25px;
            padding-right:25px;
            padding-top:20px;
            padding-bottom:0px;
            }

        .choices__list {
            border: 0px solid!important;
        }

        .choices__list--dropdown {
           position:relative;
        }

        .choices__list--multiple .choices__item {
            color:#274970;
            border:1px solid #274970;
            background-color: #ffffff;
            font-weight:300;
        }

        .is-highlighted {
            background-color: #274970!important;
            color: #ffffff!important;
        }

        .choices__button{
            border-left: 1px solid #274970!important;
            background-image: url(data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMSAyMSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMyNzQ5NzA7ZmlsbC1ydWxlOmV2ZW5vZGQ7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT54LWJsdWU8L3RpdGxlPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTIuNiwwLDIxLDE4LjQsMTguNCwyMSwwLDIuNloiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik0wLDE4LjQsMTguNCwwbDIuNSwyLjVMMi41LDIwLjlaIi8+PC9zdmc+)!important;
        }

        #is-highlighted > .choices__button {
            background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjRkZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==)!important;
        }
        .choices__item{
            color:#274970;
            font-weight:300;
        }

        .analyze-header{
            font-weight: 400;
            font-size: 30px;
            color: #274970;
            margin-bottom: 14px;
            border: 1px solid #274970!important;
            padding-top: 40px;
            padding-bottom: 20px;
            width: 80%;
            border-radius: 30px
        }

        .compare-button{
            font-weight: 400;
            color: white!important;
            font-size:21px;
            border: 1px solid #274970;
            background-color: #274970;
		    padding-left:31px;
		    padding-right:31px;
		    padding-top:8px;
		    padding-bottom:8px;
		    border-radius:24px;
		    width:250px;
		    cursor:pointer
        }

        .choices__input {
            background-color: #ffffff;
        }

        .choices__inner {
            border-radius:22px!important;
            background-color: #ffffff!important;
            border: 1px solid #ddd!important;
        }

        .is_open .choices__inner {
            border-radius:22px!important;
            background-color: #ffffff!important;
            border: 1px solid #ddd!important;
        }

        .choices__list--dropdown{
            border-radius:14px
        }

        select{
            color: #274970;
            font-weight: 400;
            text-align:center;
            padding-top:5px;
            padding-bottom:5px;
            padding-left:10px;
            padding-right:10px;
            border-radius: 15px;
            border: 1px solid #ddd;
        }

        select:focus{
            border: 1px solid #ddd!important;
            background-color: #ffffff;
        }

        .dig-in-deeper{
            font-size:16px;
            padding-top:30px;
            color:rgba(0,0,0,.7);
            font-weight:400;
            text-align:center;
        }

        .explore-data-analytics{
            font-size:34px!important;
        }

        .football-baseball-icon{
            height:37px;
            margin-right:10px;
            margin-bottom:8px;
        }

        .hockey-icon{
            height:37px;
            margin-right:6px;
            margin-bottom:6px;
        }

        .basketball-icon{
            height:46px;
            margin-right:5px;
            margin-bottom:7px
        }

        .explore-description{
            margin-bottom:10px;
        }

        .predict-text{
            font-size:21px!important;
        }

        input{
            font-weight:300;
            padding-top:5px;
            padding-bottom:5px;
            padding-left:10px;
            padding-right:10px;
            border-radius: 15px;
            border: 1px solid #ddd;
            color: #274970;
            text-align: center;
        }

        input:focus{
            border: none!important;
        }

        .input:-internal-autofill-selected {
            background-color: white!important;
            border-radius:15px;
        }

        .generating-css {
          background-color: #f6f7fa!important;
          background: linear-gradient(90deg, #f6f7fa, #4EC48F, #f6f7fa);
          -webkit-background-clip: text;
          background-clip: text;
          -webkit-text-fill-color: transparent;
          background-repeat: no-repeat;
          background-size: 80%;
          animation: shine 1.4s linear infinite;
          position: relative;
          display: inline-block;
        }

        @keyframes shine {
          0% {
            background-position-x: -500%;
          }
          100% {
            background-position-x: 500%;
          }
        }

        @media screen and (max-width: 820px) {

            .analyze-header{
                font-size: 24px;
                width:100%;
            }

            .dig-in{
                width:90%;
                max-width:600px;
                margin:auto
            }

            .dig-in-deeper{
                font-size:16px;
                padding-top:30px;
                color:#4EC48F;
                font-weight:400;
                text-align:center;
            }

            .dig-in-deeper:hover{
                font-weight:500!important;
            }
            .explore-data-analytics{
                font-size:20px!important;
            }

            .football-baseball-icon{
                height:22px;
                margin-right:5px;
                margin-bottom:4px;
            }

            .hockey-icon{
                height:22px;
                margin-right:3px;
                margin-bottom:3px;
            }

            .basketball-icon{
                height:31px;
                margin-right:2px;
                margin-bottom:3px
            }

            .explore-description{
                margin-bottom:0px;
            }

             .explore-text{
                font-size:16px!important;
            }

            .choices__list--multiple .choices__item {
                font-size:10px;
                word-wrap: normal !important;
                white-space: normal;
            }

            .choices__list--dropdown .choices__item {
                font-size:10px;
                word-wrap: normal !important;
                white-space: normal;
            }

            .compare-button{
                font-size:16px;
            }

            .mobile-margin-top{
                margin-top:10px;
            }

            p{
                margin-bottom:12px;
            }
            .post-title-detail{
                font-size: 45px!important;
                margin-top: 20px!important;
                line-height: 0px!important;
            }
        }

    </style>

    <div class="all-content" id="explore-home">
        <div class="user-post-and-comments">

            <div style="box-shadow: 0 0px 0px rgb(0 0 0 / 10%), 0 0px 0px rgb(0 0 0 / 10%)!important; background-color: #f5f7fa!important; box-shadow: 0px!important; border:none;" class="user-post row">
                <div class="darkmode-flip post-title-detail darkmode-flip">Explore</div><br>
                <h20><center class="explore-description">The best sports analytics tool on the internet</center></h20><br>

                {% if sport_name == "NBA" %}
                <h21 class="explore-data-analytics"><center><img src="{% static 'images/basketball.svg'%}" class="basketball-icon">NBA Data & Analytics</center></h21>
                {% elif sport_name == "NFL" or sport_name == "NFL-CBS" %}
                <h21 class="explore-data-analytics"><center><img src="{% static 'images/football.svg'%}" class="football-baseball-icon">NFL Data & Analytics</center></h21>
                {% elif sport_name == "MLB" %}
                <h21 class="explore-data-analytics"><center><img src="{% static 'images/baseball.svg'%}" class="football-baseball-icon">MLB Data & Analytics</center></h21>
                {% elif sport_name == "NHL" %}
                <h21 class="explore-data-analytics"><center><img src="{% static 'images/hockey.svg'%}" class="hockey-icon">NHL Data & Analytics</center></h21>
                {% endif %}

                <h21 class="hidden-sm-down"><center><a href="{% url 'help' %}"><span style="font-weight:800; color:gray">Help Page & Video Tutorials</span></a></center></h21>
                <div class="hidden-sm-down"><br></div>

                {% if sport_name == "NBA" %}
                <div id="nba_home_1" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">
                    <div class="explore-home-table-1">
                        <br>
                        <center><h19><button name='player-stats' class="csv-link" onclick="getPlayerStats()"><img src="{% static 'images/blue-player.svg'%}" style="height:35px; margin-bottom:5px; margin-right:6px">Player Stats</button></h19></center>
                        <div class="explain"><center>Player Stats gives you 5 years of player data, to let you understand how each player is trending.</center><br></div>
                        <center><button onclick="projectNBAPlayers()" class="compare-link">Get Player Prop Projections</button></center>
                        <center><button onclick="compareNBAPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>

                    </div>
                    <div class="explore-home-table-2">
                        <br>
                        <center><h19><button name="fantasy-stats" class="csv-link" onclick="getDailyFantasyStats()"><img src="{% static 'images/blue-fantasy.svg'%}" style="height:35px; margin-bottom:5px; margin-right:12px">Fantasy Stats</button></h19></center>
                        <div class="explain"><center>Fantasy Stats gives you 5 years of fantasy data, to let you build the best team possible.</center><br></div>
                        <center><button onclick="projectNBADFSPlayers()" class="compare-link">Get Fantasy Projections</button></center>
                        <center><button onclick="compareNBADFSPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>
                    </div>
                </div>
                <div id="nba_home_2" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">

                    <div class="explore-home-table-3">
                        <br>
                        <center><h19><button name="game-stats" class="csv-link" onclick="getGameStats()"><img src="{% static 'images/blue-scoreboard.svg'%}" style="height:28px; margin-right:15px; margin-bottom:2px">Game Stats</button></h19></center>
                        <div class="explain"><center>Games Stats gives you everything you need to know about every game played in the last 5 years.</center><br></div>
                        <center><button onclick="mobileNBAgetLatestSpreadsAndResults()" class="compare-link">Latest Spreads and Results</button></center>
                        <center><button onclick="mobileNBAgetLatestOUAndResults()" class="compare-link">Latest Over/Unders and Results</button></center>
                    </div>
                    <div class="explore-home-table-4">
                        <br>
                        <center><h19><button name="team-stats" class="csv-link" onclick="getTeamStats()"><img src="{% static 'images/blue-team.svg'%}" style="height:38px; margin-bottom: 5px; margin-right:12px">Team Stats</button></h19></center>
                        <div class="explain"><center>Team Stats gives you 5 years of team data, to let you understand how each team is trending.</center><br></div>
                        <center><button onclick="compareNBATeams()" class="compare-link">Analyze & Compare Teams</button></center>
                    </div>
                </div>
                <div id="nba_mobile" class="row d-flex justify-content-center mt-100 hidden-md-up mobile-margin-top">
                    <div class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <div class="post-content standard-text">
                                <center>
                                    <center><button onclick="projectNBAPlayers()" class="compare-link-mobile" style="margin-top:15px"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Player Prop Projections</span></strong></button></center>
                                    <center><button onclick="projectNBADFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Fantasy Projections</span></strong></button></center>
                                    <center><button onclick="compareNBADFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Players</span></strong></button></center>
                                    <center><button onclick="compareNBATeams()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Teams</span></strong></button></center>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row d-flex justify-content-center mt-100 mobile-margin-top">
                    <div id="nba_compare_teams" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNBAHome(0)" class="nav-link dtale-link" name="nba_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Teams</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the teams you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_team_select" multiple>
                                            {% for team in teams %}
                                            <option value="{{team}}" >{{team}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBATeams()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_team_stats_select" multiple>
                                            {% for column in team_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBATeamStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nba_team_date_range" name="nba_team_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_2" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNBATeamCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nba_compare_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNBAHome(0)" class="nav-link dtale-link" name="nba_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_player_select" multiple>
                                            {% for player in players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBAPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_player_stats_select" multiple>
                                            {% for column in player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBAPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nba_player_date_range" name="nba_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_3" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNBAPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nba_compare_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNBAHome(0)" class="nav-link dtale-link" name="nba_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_dfs_player_select" multiple>
                                            {% for player in dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBADFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_dfs_player_stats_select" multiple>
                                            {% for column in dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBADFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nba_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px" name="nba_dfs_player_date_range">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNBADFSPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nba_project_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNBAHome(0)" class="nav-link dtale-link" name="nba_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Player Prop Projections</strong></p>
                                    <center><a href="/stats/props/{{sport_name}}/" target="_blank" class="search-props">Search All Available Props</a></center>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_project_player_select" multiple>
                                            {% for player in prop_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBAProjectPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_project_player_stats_select" multiple>
                                            {% for column in fp_player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBAProjectPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="nba_project_player_date_range" name="nba_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the types games you would like to use</span><br></strong></span>
                                    <select id="nba_project_player_split" name="nba_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for split in player_project_split %}
                                        {% if forloop.counter == 1 %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}" selected>{{split}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}">{{split}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Enter the player prop line</span><br></strong></span>
                                    <input type="text" name="player_prop" required="" id="nba_project_player_prop">
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNBAPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nba_project_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNBAHome(0)" class="nav-link dtale-link" name="nba_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Fantasy Projections</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_project_dfs_player_select" multiple>
                                            {% for player in prop_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNBAProjectDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nba_project_dfs_player_stats_select" multiple>
                                            {% for column in fp_dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearProjectNBADFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="nba_project_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;" name="nba_dfs_player_date_range">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNBADFSPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>
                {% elif sport_name == "NFL" or sport_name == "NFL-CBS" %}
                <div id="nfl_home_1" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">
                    <div class="explore-home-table-1">
                        <br>
                        <center><h19><button name='player-stats' class="csv-link" onclick="getPlayerStats()"><img src="{% static 'images/blue-player.svg'%}" style="height:35px; margin-bottom:5px; margin-right:6px">Player Stats</button></h19></center>
                        <div class="explain"><center>Player Stats gives you 5 years of player data, to let you understand how each player is trending.</center><br></div>
                        <center><button onclick="projectNFLPlayers()" class="compare-link">Get Player Prop Projections</button></center>
                        <center><button onclick="compareNFLPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>

                    </div>
                    <div class="explore-home-table-2">
                        <br>
                        <center><h19><button name="fantasy-stats" class="csv-link" onclick="getDailyFantasyStats()"><img src="{% static 'images/blue-fantasy.svg'%}" style="height:35px; margin-bottom:5px; margin-right:12px">Fantasy Stats</button></h19></center>
                        <div class="explain"><center>Fantasy Stats gives you 5 years of fantasy data, to let you build the best team possible.</center><br></div>
                        <center><button onclick="projectNFLDFSPlayers()" class="compare-link">Get Fantasy Projections</button></center>
                        <center><button onclick="compareNFLDFSPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>
                    </div>
                </div>
                <div id="nfl_home_2" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">

                    <div class="explore-home-table-3">
                        <br>
                        <center><h19><button class="csv-link"  name="game-stats" onclick="getGameStats()"><img src="{% static 'images/blue-scoreboard.svg'%}" style="height:28px; margin-right:15px; margin-bottom:2px">Game Stats</button></h19></center>
                        <div class="explain"><center>Games Stats gives you everything you need to know about every game played in the last 5 years.</center><br></div>
                        <center><button onclick="mobileNFLgetLatestSpreadsAndResults()" class="compare-link">Latest Spreads and Results</button></center>
                        <center><button onclick="mobileNFLgetLatestOUAndResults()" class="compare-link">Latest Over/Unders and Results</button></center>
                    </div>
                    <div class="explore-home-table-4">
                        <br>
                        <center><h19><button name="team-stats" class="csv-link" onclick="getTeamStats()"><img src="{% static 'images/blue-team.svg'%}" style="height:38px; margin-bottom: 5px; margin-right:12px">Team Stats</button></h19></center>
                        <div class="explain"><center>Team Stats gives you 5 years of team data, to let you understand how each team is trending.</center><br></div>
                        <center><button onclick="compareNFLTeams()" class="compare-link">Analyze & Compare Teams</button></center>
                    </div>
                </div>
                <div id="nfl_mobile" class="row d-flex justify-content-center mt-100 hidden-md-up mobile-margin-top">
                    <div class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <div class="post-content standard-text">
                                <center>
                                    <center><button onclick="projectNFLPlayers()" class="compare-link-mobile" style="margin-top:15px"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Player Prop Projections</span></strong></button></center>
                                    <center><button onclick="projectNFLDFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Fantasy Projections</span></strong></button></center>
                                    <center><button onclick="compareNFLDFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Players</span></strong></button></center>
                                    <center><button onclick="compareNFLTeams()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Teams</span></strong></button></center>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row d-flex justify-content-center mt-100 mobile-margin-top">
                    <div id="nfl_compare_teams" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNFLHome(0)" class="nav-link dtale-link" name="nfl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Teams</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the teams you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_team_select" multiple>
                                            {% for team in teams %}
                                            <option value="{{team}}" >{{team}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLTeams()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_team_stats_select" multiple>
                                            {% for column in team_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLTeamStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nfl_team_date_range" name="nfl_team_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_2" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNFLTeamCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nfl_compare_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNFLHome(0)" class="nav-link dtale-link" name="nfl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_player_select" multiple>
                                            {% for player in players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_player_stats_select" multiple>
                                            {% for column in player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nfl_player_date_range" name="nfl_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_3" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNFLPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nfl_compare_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNFLHome(0)" class="nav-link dtale-link" name="nfl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_dfs_player_select" multiple>
                                            {% for player in dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_dfs_player_stats_select" multiple>
                                            {% for column in dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLDFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nfl_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px" name="nfl_dfs_player_date_range">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNFLDFSPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nfl_project_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNFLHome(0)" class="nav-link dtale-link" name="nfl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Player Prop Projections</strong></p>
                                    <center><a href="/stats/props/{{sport_name}}/" target="_blank" class="search-props">Search All Available Props</a></center>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_project_player_select" multiple>
                                            {% for player in prop_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLProjectPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_project_player_stats_select" multiple>
                                            {% for column in fp_player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLProjectPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="nfl_project_player_date_range" name="nfl_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the types games you would like to use</span><br></strong></span>
                                    <select id="nfl_project_player_split" name="nba_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for split in player_project_split %}
                                        {% if forloop.counter == 1 %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}" selected>{{split}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}">{{split}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Enter the player prop line</span><br></strong></span>
                                    <input type="text" name="player_prop" required="" id="nfl_project_player_prop">
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNFLPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nfl_project_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNFLHome(0)" class="nav-link dtale-link" name="nfl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Fantasy Projections</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_project_dfs_player_select" multiple>
                                            {% for player in prop_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNFLProjectDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nfl_project_dfs_player_stats_select" multiple>
                                            {% for column in fp_dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearProjectNFLDFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="nfl_project_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;" name="nfl_dfs_player_date_range">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNFLDFSPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>
                {%elif sport_name == "MLB" %}

                <div id="mlb_home_1" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">
                    <div class="explore-home-table-1">
                        <br>
                        <center><h19><button name='player-stats' class="csv-link" onclick="getPlayerStats()"><img src="{% static 'images/blue-player.svg'%}" style="height:35px; margin-bottom:5px; margin-right:6px">Player Stats</button></h19></center>
                        <div class="explain"><center>Player Stats gives you 5 years of player data, to let you understand how each player is trending.</center><br></div>
                        <center><button onclick="projectMLBPlayers()" class="compare-link">Get Player Prop Projections</button></center>
                        <center><button onclick="compareMLBPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>

                    </div>
                    <div class="explore-home-table-2">
                        <br>
                        <center><h19><button name="fantasy-stats" class="csv-link" onclick="getDailyFantasyStats()"><img src="{% static 'images/blue-fantasy.svg'%}" style="height:35px; margin-bottom:5px; margin-right:12px">Fantasy Stats</button></h19></center>
                        <div class="explain"><center>Fantasy Stats gives you 5 years of fantasy data, to let you build the best team possible.</center><br></div>
                        <center><button onclick="projectMLBDFSPlayers()" class="compare-link">Get Fantasy Projections</button></center>
                        <center><button onclick="compareMLBDFSPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>
                    </div>
                </div>
                <div id="mlb_home_2" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">

                    <div class="explore-home-table-3">
                        <br>
                        <center><h19><button class="csv-link"  name="game-stats" onclick="getGameStats()"><img src="{% static 'images/blue-scoreboard.svg'%}" style="height:28px; margin-right:15px; margin-bottom:2px">Game Stats</button></h19></center>
                        <div class="explain"><center>Games Stats gives you everything you need to know about every game played in the last 5 years.</center><br></div>
                        <center><button onclick="mobileMLBgetLatestSpreadsAndResults()" class="compare-link">Latest Spreads and Results</button></center>
                        <center><button onclick="mobileMLBgetLatestOUAndResults()" class="compare-link">Latest Over/Unders and Results</button></center>
                    </div>
                    <div class="explore-home-table-4">
                        <br>
                        <center><h19><button name="team-stats" class="csv-link" onclick="getTeamStats()"><img src="{% static 'images/blue-team.svg'%}" style="height:38px; margin-bottom: 5px; margin-right:12px">Team Stats</button></h19></center>
                        <div class="explain"><center>Team Stats gives you 5 years of team data, to let you understand how each team is trending.</center><br></div>
                        <center><button onclick="compareMLBTeams()" class="compare-link">Analyze & Compare Teams</button></center>
                    </div>
                </div>
                <div id="mlb_mobile" class="row d-flex justify-content-center mt-100 hidden-md-up mobile-margin-top">
                    <div class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <div class="post-content standard-text">
                                <center>
                                    <center><button onclick="projectMLBPlayers()" class="compare-link-mobile" style="margin-top:15px"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;line-height:24px; display:inline-block;margin-top:10px">Get Player Prop Projections</span></strong></button></center>
                                    <center><button onclick="projectMLBDFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Fantasy Projections</span></strong></button></center>
                                    <center><button onclick="compareMLBDFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Players</span></strong></button></center>
                                    <center><button onclick="compareMLBTeams()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Teams</span></strong></button></center>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row d-flex justify-content-center mt-100 mobile-margin-top">
                    <div id="mlb_compare_teams" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getMLBHome(0)" class="nav-link dtale-link" name="mlb_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Teams</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the teams you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_team_select" multiple>
                                            {% for team in teams %}
                                            <option value="{{team}}" >{{team}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBTeams()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_team_stats_select" multiple>
                                            {% for column in team_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBTeamStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="mlb_team_date_range" name="mlb_team_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_2" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileMLBTeamCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="mlb_compare_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getMLBHome(0)" class="nav-link dtale-link" name="mlb_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_player_select" multiple>
                                            {% for player in players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_player_stats_select" multiple>
                                            {% for column in player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="mlb_player_date_range" name="mlb_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_3" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileMLBPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="mlb_compare_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getMLBHome(0)" class="nav-link dtale-link" name="mlb_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_dfs_player_select" multiple>
                                            {% for player in dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_dfs_player_stats_select" multiple>
                                            {% for column in dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBDFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="mlb_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px" name="mlb_dfs_player_date_range">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileMLBDFSPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="mlb_project_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getMLBHome(0)" class="nav-link dtale-link" name="mlb_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Player Prop Projections</strong></p>
                                    <center><a href="/stats/props/{{sport_name}}/" target="_blank" class="search-props">Search All Available Props</a></center>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_project_player_select" multiple>
                                            {% for player in fp_dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBProjectPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_project_player_stats_select" multiple>
                                            {% for column in fp_player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBProjectPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="mlb_project_player_date_range" name="mlb_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the types games you would like to use</span><br></strong></span>
                                    <select id="mlb_project_player_split" name="nba_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for split in player_project_split %}
                                        {% if forloop.counter == 1 %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}" selected>{{split}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}">{{split}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Enter the player prop line</span><br></strong></span>
                                    <input type="text" name="player_prop" required="" id="mlb_project_player_prop">
                                    <br><br>
                                    <a class="compare-button" onclick="MobileMLBPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="mlb_project_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getMLBHome(0)" class="nav-link dtale-link" name="mlb_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Fantasy Projections</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_project_dfs_player_select" multiple>
                                            {% for player in fp_dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearMLBProjectDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="mlb_project_dfs_player_stats_select" multiple>
                                            {% for column in fp_dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearProjectMLBDFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="mlb_project_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;" name="mlb_dfs_player_date_range">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileMLBDFSPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>
                {%elif sport_name == "NHL" %}
                <div id="nhl_home_1" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">
                    <div class="explore-home-table-1">
                        <br>
                        <center><h19><button name='player-stats' class="csv-link" onclick="getPlayerStats()"><img src="{% static 'images/blue-player.svg'%}" style="height:35px; margin-bottom:5px; margin-right:6px">Player Stats</button></h19></center>
                        <div class="explain"><center>Player Stats gives you 5 years of player data, to let you understand how each player is trending.</center><br></div>
                        <center><button onclick="projectNHLPlayers()" class="compare-link">Get Player Prop Projections</button></center>
                        <center><button onclick="compareNHLPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>

                    </div>
                    <div class="explore-home-table-2">
                        <br>
                        <center><h19><button name="fantasy-stats" class="csv-link" onclick="getDailyFantasyStats()"><img src="{% static 'images/blue-fantasy.svg'%}" style="height:35px; margin-bottom:5px; margin-right:12px">Fantasy Stats</button></h19></center>
                        <div class="explain"><center>Fantasy Stats gives you 5 years of fantasy data, to let you build the best team possible.</center><br></div>
                        <center><button onclick="projectNHLDFSPlayers()" class="compare-link">Get Fantasy Projections</button></center>
                        <center><button onclick="compareNHLDFSPlayers()" class="compare-link" style="margin-bottom:35px">Analyze & Compare Players</button></center>
                    </div>
                </div>
                <div id="nhl_home_2" class="row hidden-sm-down hidden-small-height" style="margin: auto!important;">

                    <div class="explore-home-table-3">
                        <br>
                        <center><h19><button class="csv-link"  name="game-stats" onclick="getGameStats()"><img src="{% static 'images/blue-scoreboard.svg'%}" style="height:28px; margin-right:15px; margin-bottom:2px">Game Stats</button></h19></center>
                        <div class="explain"><center>Games Stats gives you everything you need to know about every game played in the last 5 years.</center><br></div>
                        <center><button onclick="mobileNHLgetLatestSpreadsAndResults()" class="compare-link">Latest Spreads and Results</button></center>
                        <center><button onclick="mobileNHLgetLatestOUAndResults()" class="compare-link">Latest Over/Unders and Results</button></center>
                    </div>
                    <div class="explore-home-table-4">
                        <br>
                        <center><h19><button name="team-stats" class="csv-link" onclick="getTeamStats()"><img src="{% static 'images/blue-team.svg'%}" style="height:38px; margin-bottom: 5px; margin-right:12px">Team Stats</button></h19></center>
                        <div class="explain"><center>Team Stats gives you 5 years of team data, to let you understand how each team is trending.</center><br></div>
                        <center><button onclick="compareNHLTeams()" class="compare-link">Analyze & Compare Teams</button></center>
                    </div>
                </div>
                <div id="nhl_mobile" class="row d-flex justify-content-center mt-100 hidden-md-up mobile-margin-top">
                    <div class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <div class="post-content standard-text">
                                <center>
                                    <center><button onclick="projectNHLPlayers()" class="compare-link-mobile" style="margin-top:15px"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Player Prop Projections</span></strong></button></center>
                                    <center><button onclick="projectNHLDFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970; line-height:24px; display:inline-block;margin-top:10px">Get Fantasy Projections</span></strong></button></center>
                                    <center><button onclick="compareNHLDFSPlayers()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:50px; margin-top:7px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Players</span></strong></span></button></center>
                                    <center><button onclick="compareNHLTeams()" class="compare-link-mobile"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-right:6px;"><br><span class="darkmode-flip" style="color: #274970;">Analyze & Compare Teams</span></strong></button></center>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row d-flex justify-content-center mt-100 mobile-margin-top">
                    <div id="nhl_compare_teams" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNHLHome(0)" class="nav-link dtale-link" name="nhl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-team.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Teams</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the teams you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_team_select" multiple>
                                            {% for team in teams %}
                                            <option value="{{team}}" >{{team}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLTeams()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_team_stats_select" multiple>
                                            {% for column in team_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLTeamStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nhl_team_date_range" name="nhl_team_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_2" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNHLTeamCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nhl_compare_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNHLHome(0)" class="nav-link dtale-link" name="nhl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-player.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_player_select" multiple>
                                            {% for player in players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_player_stats_select" multiple>
                                            {% for column in player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nhl_player_date_range" name="nhl_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_3" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNHLPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nhl_compare_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNHLHome(0)" class="nav-link dtale-link" name="nhl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Analyze & Compare Players</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the players you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_dfs_player_select" multiple>
                                            {% for player in dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stats you would like to analyze</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_dfs_player_stats_select" multiple>
                                            {% for column in dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLDFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the date range</span><br></strong></span>
                                    <select id="nhl_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px" name="nhl_dfs_player_date_range">
                                        <option class="explore-text" style="color:#274970" value="{{this_season}}">This Season</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_week}}">Last Week</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_month}}">Last Month</option>
                                        <option class="explore-text" style="color:#274970" value="{{last_year}}">Last Year</option>
                                        <option class="explore-text" style="color:#274970" value="all_time">All Time</option>
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNHLDFSPlayerCompareButton()">Analyze</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nhl_project_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNHLHome(0)" class="nav-link dtale-link" name="nhl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-projection_bold.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Player Prop Projections</strong></p>
                                    <center><a href="/stats/props/{{sport_name}}/" target="_blank" class="search-props">Search All Available Props</a></center>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_project_player_select" multiple>
                                            {% for player in fp_dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLProjectPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_project_player_stats_select" multiple>
                                            {% for column in fp_player_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLProjectPlayerStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="nhl_project_player_date_range" name="nhl_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the types games you would like to use</span><br></strong></span>
                                    <select id="nhl_project_player_split" name="nba_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px">
                                        {% for split in player_project_split %}
                                        {% if forloop.counter == 1 %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}" selected>{{split}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{split}}">{{split}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Enter the player prop line</span><br></strong></span>
                                    <input type="text" name="player_prop" required="" id="nhl_project_player_prop">
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNHLPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                    <div id="nhl_project_dfs_players" style="display:none" class="user-post-and-comments">
                        <div class="user-post row" style="width:90%; max-width:600px; margin:auto">
                            <a onclick="getNHLHome(0)" class="nav-link dtale-link" name="nhl_back_home" style="color:#274970"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            <br>
                            <div class="post-content standard-text explore-text">
                                <center>
                                    <p class="analyze-header"><strong><img src="{% static 'images/blue-fantasy.svg'%}" style="height:55px; margin-bottom:8px; margin-right:6px; margin-top:-30px"><br>Fantasy Projections</strong></p>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the player you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_project_dfs_player_select" multiple>
                                            {% for player in fp_dfs_players %}
                                            <option value="{{player}}" >{{player}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearNHLProjectDFSPlayers()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the stat you would like to project</span><br></strong></span>
                                    <div class="col-xs-11" style="float: none;text-align: left;">
                                        <select id="nhl_project_dfs_player_stats_select" multiple>
                                            {% for column in fp_dfs_columns %}
                                            <option value="{{column}}" >{{column}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <span class="compare-link" style="padding-left:15px; padding-right:15px; padding-top:3px; padding-bottom:1.5px;"><a onclick="clearProjectNHLDFSStats()">Clear</a></span><br>
                                    <span class="explore-text"><strong style="rgba(0,0,0,.9)"><br><span style="display: inline-block;margin-bottom:14px">Select the amount of historic games you would like to use</span><br></strong></span>
                                    <select id="nhl_project_dfs_player_date_range" style="font-size:18px; color:#274970; padding-left:10px;padding-right:10px; background-color:white;" name="nhl_dfs_player_date_range">
                                        {% for number in player_project_games %}
                                        {% if forloop.counter == 10 %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}" selected>{{number}}</option>
                                        {% else %}
                                        <option class="explore-text" style="color:#274970" value="{{number}}">{{number}}</option>
                                        {% endif %}
                                        {% endfor %}
                                    </select>
                                    <br><br>
                                    <span class="flag_on_4" style="display:none; color:#b22234; font-size:14px"><img src="{% static 'images/red_flag.svg'%}" style="width:30px">&nbsp;You have additional filters saved in View.</span>
                                    <br><br>
                                    <a class="compare-button" onclick="MobileNHLDFSPlayerProjectButton()">Project</a>
                                    <br><br>
                                </center>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                <div id="mobile-chart" class="row d-flex justify-content-center mt-100 mobile-margin-top" style="display:none">
                    <div class="user-post-and-comments">
                        <div class="user-post row dig-in" style="margin: auto; max-width:807px">
                            {% if sport_name == "NBA" %}
                            <a onclick="getNBAHome(0)" class="nav-link dtale-link" id="nba_back_home_mobile" style="color:#274970; float:left"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            {% elif "NFL" in sport_name %}
                            <a onclick="getNFLHome(0)" class="nav-link dtale-link" id="nfl_back_home_mobile" style="color:#274970; float:left"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            {% elif sport_name == "MLB" %}
                            <a onclick="getMLBHome(0)" class="nav-link dtale-link" id="mlb_back_home_mobile" style="color:#274970; float:left"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            {% elif sport_name == "NHL" %}
                            <a onclick="getNHLHome(0)" class="nav-link dtale-link" id="nhl_back_home_mobile" style="color:#274970; float:left"><img src="{% static 'images/black-back.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a>
                            {% endif %}
                            <span style="float:right"><a id="save-mobile" target="popup" onclick="window.open('','popup'); return false;" href=""><img style="width:21px; margin-top:1px;" src="{% static 'images/save.svg'%}" class="dtale-link-icon" title="Select" class="img-responsive"></a><a id="camera-mobile" target="popup" onclick="window.open('','popup'); return false;" href=""><img style="margin-left:5px; width:25px; margin-top:1px;" src="{% static 'images/camera.svg'%}?v=1" class="dtale-link-icon" title="Select" class="img-responsive"></a></span>
                            <br>
                            <span class="hidden-sm-down"><br><br></span>
                            <div class="post-content standard-text">
                                <center>
                                    <div class="chart-div-1"><div class="chart-div-2"></div><div id="mobile-chart-embed" class="chart-div-3"><embed src="{% url 'analyze' user_id random_number %}" height="100%" width="100%" style="margin:auto"></div></div>
                                </center>
                                {% if is_group %}<p class="hidden-sm-down dig-in-deeper"><a id="dig-in-link" onclick=""> Dig in deeper with Explore+</a></p>{% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <br>
            </div>
            <center class="footer-font"><a href="/privacy/">Privacy Policy</a> | <a href="/terms/">Terms & Conditions</a></center><br>
        </div>
    </div>

    <div class="dtale-iframe" id="dtale-iframe" style="margin-top: 0px !important; display:none">
        <iframe src=" " width="100%" height="100%" title="Iframe Example" id="csv_data">
        </iframe>
    </div>

</div>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

<script>
    var instanceId = {{user_id}} +'_'+'1'; //This should be the user's initial instanceID, place initial instanceid Django variable here.
    var lastDate = '{{last_game}}';
    var lastNFLWeek = {{last_nfl_week}};

    var NBATeamSelectButton = new Choices('#nba_team_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:35, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 35 teams.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBATeamStatsSelectButton = new Choices('#nba_team_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBAPlayerSelectButton = new Choices('#nba_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBAProjectPlayerSelectButton = new Choices('#nba_project_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBAPlayerStatsSelectButton = new Choices('#nba_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBAProjectPlayerStatsSelectButton = new Choices('#nba_project_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBADFSPlayerSelectButton = new Choices('#nba_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBAProjectDFSPlayerSelectButton = new Choices('#nba_project_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBADFSPlayerStatsSelectButton = new Choices('#nba_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NBAProjectDFSPlayerStatsSelectButton = new Choices('#nba_project_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLTeamSelectButton = new Choices('#nfl_team_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:35, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 35 teams.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLTeamStatsSelectButton = new Choices('#nfl_team_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLPlayerSelectButton = new Choices('#nfl_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLProjectPlayerSelectButton = new Choices('#nfl_project_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });


    var NFLPlayerStatsSelectButton = new Choices('#nfl_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLProjectPlayerStatsSelectButton = new Choices('#nfl_project_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });


    var NFLDFSPlayerSelectButton = new Choices('#nfl_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLProjectDFSPlayerSelectButton = new Choices('#nfl_project_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLDFSPlayerStatsSelectButton = new Choices('#nfl_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NFLProjectDFSPlayerStatsSelectButton = new Choices('#nfl_project_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBTeamSelectButton = new Choices('#mlb_team_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:35, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 35 teams.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBTeamStatsSelectButton = new Choices('#mlb_team_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBPlayerSelectButton = new Choices('#mlb_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBProjectPlayerSelectButton = new Choices('#mlb_project_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBPlayerStatsSelectButton = new Choices('#mlb_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBProjectPlayerStatsSelectButton = new Choices('#mlb_project_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBDFSPlayerSelectButton = new Choices('#mlb_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBProjectDFSPlayerSelectButton = new Choices('#mlb_project_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBDFSPlayerStatsSelectButton = new Choices('#mlb_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var MLBProjectDFSPlayerStatsSelectButton = new Choices('#mlb_project_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLTeamSelectButton = new Choices('#nhl_team_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:35, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 35 teams.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLTeamStatsSelectButton = new Choices('#nhl_team_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLPlayerSelectButton = new Choices('#nhl_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLProjectPlayerSelectButton = new Choices('#nhl_project_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLPlayerStatsSelectButton = new Choices('#nhl_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLProjectPlayerStatsSelectButton = new Choices('#nhl_project_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLDFSPlayerSelectButton = new Choices('#nhl_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:30, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 30 players.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLProjectDFSPlayerSelectButton = new Choices('#nhl_project_dfs_player_select', {
        removeItemButton: true,
        shouldSort: true, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'Great choice!'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLDFSPlayerStatsSelectButton = new Choices('#nhl_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:5, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'You have reached your maximum of 5 stats.'
        //renderChoiceLimit:201 //shows 200 records
    });

    var NHLProjectDFSPlayerStatsSelectButton = new Choices('#nhl_project_dfs_player_stats_select', {
        removeItemButton: true,
        shouldSort: false, //retains original order
        maxItemCount:1, //Set select limit
        searchResultLimit:25, // search result limit
        maxItemText: 'I like it!'
        //renderChoiceLimit:201 //shows 200 records
    });


    //Loads initial spreadsheet on start
    window.onload = function(){
        setTimeout(function(){

            document.getElementById('pine-container').style.display="block";
            document.getElementById('explore-home').style.display="block";
            document.getElementById('dtale-iframe').style.display="none";

            //work on hiding spreadsheet menu
            try{
                document.getElementById('spreadsheet-menu').style.display="none";
                document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
            }
            catch{
                console.log("Exception");
            }

            //gets last date in datasheet
            //getDate();

            //Checks notifications on start
            {%if new_notifications %}
             notification_icons = document.getElementsByName('notifications')
             for(var x=0;x<=notification_icons.length;x++){
                   notification_icons[x].src="{% static 'images/black-notifications_alert.svg'%}"
             }
            {% endif %}
        });
    };

   //function to get last date in datasheet -- no need anymore, gets data directly from datasheet
    async function getDate(){
        var url="/dtale/describe/" + instanceId + "/Date"
        var dateFetch = await fetch(url);
        var dateJson = await dateFetch.text();
        var dateInfo = JSON.parse(dateJson);
        lastDate = dateInfo.describe.last;
    }

    async function buildQuery(sport, team_or_player, names, date_range, date_selected){

        var save_url = '/dtale/column-analysis/' + instanceId
        var queryFetch = await fetch(save_url);
        var queryJson = await queryFetch.text();
        var queryInfo = JSON.parse(queryJson);
        var pine_query = queryInfo.query;

        var filter_url = '/dtale/save-column-filter/' + instanceId + '/'

        if (team_or_player == "team"){
            filter_url = filter_url + 'Team'
        }
        else{
            filter_url = filter_url + 'Player Name'
        }

        filter_url = filter_url + '?cfg={"type":"string","value":['

        for (let i = 0; i < names.length; i++) {
             filter_url = filter_url + '"' + names[i] + '"'
            if (i < names.length-1){
                    filter_url = filter_url + ','
            }
        }
        filter_url = filter_url + '],"operand":"="}'
        var filterFetch = await fetch(filter_url);


        filter_url = '/dtale/save-column-filter/' + instanceId + '/'

        if (date_selected){

            filter_url = filter_url + 'Date?cfg={"type":"date","start":"'+ date_range + '","end":null}'
        }
        else if (date_range != 'all_time'){
            if (sport == "MLB"){
                filter_url = filter_url + 'Season'
            }
            else{
                filter_url = filter_url + 'Season Year'
            }
            filter_url = filter_url + '?cfg={"type":"int","operand":"=","value":[' + date_range + ']}'
        }


        var filterFetch = await fetch(filter_url);


        return pine_query
    }

    function getNBAHome(choice){
        if(choice == 0){
            document.getElementById('nba_home_1').style.display="block";
            document.getElementById('nba_home_2').style.display="block";
            document.getElementById('nba_mobile').style.display="block";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 1){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="block";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 2){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="block";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 3){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="block";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
    }

    function compareNBATeams(){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="block";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareNBAPlayers(){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="block";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareNBADFSPlayers(){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="block";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectNBAPlayers(){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="block";
            document.getElementById('nba_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectNBADFSPlayers(){
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('nba_project_players').style.display="none";
            document.getElementById('nba_project_dfs_players').style.display="block";
            document.getElementById('mobile-chart').style.display="none";
    }

    function clearNBATeams(){
        NBATeamSelectButton.removeActiveItems();
    }

    function clearNBATeamStats(){
        NBATeamStatsSelectButton.removeActiveItems();
    }

    function clearNBAPlayers(){
        NBAPlayerSelectButton.removeActiveItems();
    }

    function clearNBAPlayerStats(){
        NBAPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNBAProjectPlayers(){
        NBAProjectPlayerSelectButton.removeActiveItems();
    }

    function clearNBAProjectPlayerStats(){
        NBAProjectPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNBADFSPlayers(){
        NBADFSPlayerSelectButton.removeActiveItems();
    }

    function clearNBADFSStats(){
        NBADFSPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNBAProjectDFSPlayers(){
        NBAProjectDFSPlayerSelectButton.removeActiveItems();
    }

    function clearNBAProjectDFSStats(){
        NBAProjectDFSPlayerStatsSelectButton.removeActiveItems();
    }

    async function NBATeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('nba_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('nba_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nba_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){
            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NBA", "team", team_names, date_range, date_selected)

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }

            var url = "";


            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Team&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Team&agg=mean&barmode=group"
                }

                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function NBAPlayerCompareButton(){
        //resets instance id
        instanceId = {{user_id}}+'_'+'3';

        var player_names = [];
        for (var player of document.getElementById('nba_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nba_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nba_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NBA", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function NBADFSPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nba_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nba_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nba_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NBA", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    //MOBILE
    async function MobileNBATeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('nba_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('nba_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nba_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }

            var url = "";

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{

                url = url + "%29&x=Team&agg=mean&barmode=group"


                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{
                //shows chart and hides home screen
                document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(1);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nba_home_1').style.display="none";
                document.getElementById('nba_home_2').style.display="none";
                document.getElementById('nba_mobile').style.display="none";
                document.getElementById('nba_compare_teams').style.display="none";
                document.getElementById('nba_compare_players').style.display="none";
                document.getElementById('nba_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NBATeamCompareButton()');
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function MobileNBAPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nba_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nba_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nba_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'3';

            //shows chart and hides home screen
            document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(2);" );;
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";


            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"


                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{

                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(2);" );;
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nba_home_1').style.display="none";
                document.getElementById('nba_home_2').style.display="none";
                document.getElementById('nba_mobile').style.display="none";
                document.getElementById('nba_compare_teams').style.display="none";
                document.getElementById('nba_compare_players').style.display="none";
                document.getElementById('nba_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NBAPlayerCompareButton()');
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function MobileNBADFSPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nba_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nba_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nba_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            //shows chart and hides home screen
            document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(3);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";


            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{

                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(3);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nba_home_1').style.display="none";
                document.getElementById('nba_home_2').style.display="none";
                document.getElementById('nba_mobile').style.display="none";
                document.getElementById('nba_compare_teams').style.display="none";
                document.getElementById('nba_compare_players').style.display="none";
                document.getElementById('nba_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NBADFSPlayerCompareButton()');
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    function MobileNBAPlayerProjectButton(){
        var player = document.getElementById("nba_project_player_select").value;
        var stat = document.getElementById("nba_project_player_stats_select").value;
        var games_back = document.getElementById("nba_project_player_date_range").value;
        var split = document.getElementById("nba_project_player_split").value;
        var prop = document.getElementById("nba_project_player_prop").value;
        if (prop == ""){
            prop = "none";
        }
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/' + prop + '/'+ games_back + '/' + split + '/'
        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }


    }
    function MobileNBADFSPlayerProjectButton(){
        var player = document.getElementById("nba_project_dfs_player_select").value;
        var stat = document.getElementById("nba_project_dfs_player_stats_select").value;
        var games_back = document.getElementById("nba_project_dfs_player_date_range").value;
        var prop = "none"
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/none/'+ games_back + '/'

        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }
    }

    function getNFLHome(choice){
        if(choice == 0){
            document.getElementById('nfl_home_1').style.display="block";
            document.getElementById('nfl_home_2').style.display="block";
            document.getElementById('nfl_mobile').style.display="block";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 1){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="block";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 2){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="block";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 3){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="block";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
    }

    function compareNFLTeams(){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="block";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareNFLPlayers(){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="block";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareNFLDFSPlayers(){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="block";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectNFLPlayers(){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="block";
            document.getElementById('nfl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectNFLDFSPlayers(){
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('nfl_project_players').style.display="none";
            document.getElementById('nfl_project_dfs_players').style.display="block";
            document.getElementById('mobile-chart').style.display="none";
    }

    function clearNFLTeams(){
        NFLTeamSelectButton.removeActiveItems();
    }

    function clearNFLTeamStats(){
        NFLTeamStatsSelectButton.removeActiveItems();
    }

    function clearNFLPlayers(){
        NFLPlayerSelectButton.removeActiveItems();
    }

    function clearNFLPlayerStats(){
        NFLPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNFLProjectPlayers(){
        NFLProjectPlayerSelectButton.removeActiveItems();
    }

    function clearNFLProjectPlayerStats(){
        NFLProjectPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNFLDFSPlayers(){
        NFLDFSPlayerSelectButton.removeActiveItems();
    }

    function clearNFLDFSStats(){
        NFLDFSPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNFLProjectDFSPlayers(){
        NFLProjectDFSPlayerSelectButton.removeActiveItems();
    }

    function clearNFLProjectDFSStats(){
        NFLProjectDFSPlayerStatsSelectButton.removeActiveItems();
    }

    async function NFLTeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('nfl_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('nfl_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nfl_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){
            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NFL", "team", team_names, date_range, date_selected)

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }

            //change after week 8 to only be last week
            if (select.options[select.selectedIndex].text != "Last Year"){
                scatter = false;
            }

            var url = "";


            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Team&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Team&agg=mean&barmode=group"
                }

                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function NFLPlayerCompareButton(){
        //resets instance id
        instanceId = {{user_id}}+'_'+'3';

        var player_names = [];
        for (var player of document.getElementById('nfl_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nfl_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nfl_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NFL", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            //change after week 8 to only be last week
            if (select.options[select.selectedIndex].text != "Last Year"){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function NFLDFSPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nfl_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nfl_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nfl_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NFL", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            //change after week 8 to only be last week
            if (select.options[select.selectedIndex].text != "Last Year"){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    //Mobile
    async function MobileNFLTeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('nfl_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('nfl_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nfl_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){
            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            //shows chart and hides home screen
            document.getElementById('nfl_back_home_mobile').setAttribute( "onClick", "javascript: getNFLHome(1);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }

            //change after week 8 to only be last week
            if (select.options[select.selectedIndex].text != "Last Year"){
                scatter = false;
            }

            var url = "";


            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{
                url = url + "%29&x=Team&agg=mean&barmode=group"

                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nfl_back_home_mobile').setAttribute( "onClick", "javascript: getNFLHome(1);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nfl_home_1').style.display="none";
                document.getElementById('nfl_home_2').style.display="none";
                document.getElementById('nfl_mobile').style.display="none";
                document.getElementById('nfl_compare_teams').style.display="none";
                document.getElementById('nfl_compare_players').style.display="none";
                document.getElementById('nfl_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NFLTeamCompareButton()');
            }

        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function MobileNFLPlayerCompareButton(){

        var player_names = [];
        for (var player of document.getElementById('nfl_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nfl_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nfl_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'3';

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            //change after week 8 to only be last week
            if (select.options[select.selectedIndex].text != "Last Year"){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"


                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{

                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }

            else{

                //shows chart and hides home screen
                document.getElementById('nfl_back_home_mobile').setAttribute( "onClick", "javascript: getNFLHome(2);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nfl_home_1').style.display="none";
                document.getElementById('nfl_home_2').style.display="none";
                document.getElementById('nfl_mobile').style.display="none";
                document.getElementById('nfl_compare_teams').style.display="none";
                document.getElementById('nfl_compare_players').style.display="none";
                document.getElementById('nfl_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NFLPlayerCompareButton()');
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function MobileNFLDFSPlayerCompareButton(){

        var player_names = [];
        for (var player of document.getElementById('nfl_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nfl_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nfl_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            //change after week 8 to only be last week
            if (select.options[select.selectedIndex].text != "Last Year"){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"


                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{

                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();
            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nfl_back_home_mobile').setAttribute( "onClick", "javascript: getNFLHome(3);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nfl_home_1').style.display="none";
                document.getElementById('nfl_home_2').style.display="none";
                document.getElementById('nfl_mobile').style.display="none";
                document.getElementById('nfl_compare_teams').style.display="none";
                document.getElementById('nfl_compare_players').style.display="none";
                document.getElementById('nfl_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NFLDFSPlayerCompareButton()');
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    function MobileNFLPlayerProjectButton(){
        var player = document.getElementById("nfl_project_player_select").value;
        var stat = document.getElementById("nfl_project_player_stats_select").value;
        var games_back = document.getElementById("nfl_project_player_date_range").value;
        var split = document.getElementById("nfl_project_player_split").value;
        var prop = document.getElementById("nfl_project_player_prop").value;
        if (prop == ""){
            prop = "none";
        }
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/' + prop + '/'+ games_back + '/' + split + '/'
        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }


    }
    function MobileNFLDFSPlayerProjectButton(){
        var player = document.getElementById("nfl_project_dfs_player_select").value;
        var stat = document.getElementById("nfl_project_dfs_player_stats_select").value;
        var games_back = document.getElementById("nfl_project_dfs_player_date_range").value;
        var prop = "none"
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/none/'+ games_back + '/'

        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }
    }

    function getMLBHome(choice){
        if(choice == 0){
            document.getElementById('mlb_home_1').style.display="block";
            document.getElementById('mlb_home_2').style.display="block";
            document.getElementById('mlb_mobile').style.display="block";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 1){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="block";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 2){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="block";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 3){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="block";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
    }

    function compareMLBTeams(){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="block";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareMLBPlayers(){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="block";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareMLBDFSPlayers(){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="block";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectMLBPlayers(){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="block";
            document.getElementById('mlb_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectMLBDFSPlayers(){
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mlb_project_players').style.display="none";
            document.getElementById('mlb_project_dfs_players').style.display="block";
            document.getElementById('mobile-chart').style.display="none";
    }

    function clearMLBTeams(){
        MLBTeamSelectButton.removeActiveItems();
    }

    function clearMLBTeamStats(){
        MLBTeamStatsSelectButton.removeActiveItems();
    }

    function clearMLBPlayers(){
        MLBPlayerSelectButton.removeActiveItems();
    }

    function clearMLBPlayerStats(){
        MLBPlayerStatsSelectButton.removeActiveItems();
    }

    function clearMLBProjectPlayers(){
        MLBProjectPlayerSelectButton.removeActiveItems();
    }

    function clearMLBProjectPlayerStats(){
        MLBProjectPlayerStatsSelectButton.removeActiveItems();
    }

    function clearMLBDFSPlayers(){
        MLBDFSPlayerSelectButton.removeActiveItems();
    }

    function clearMLBDFSStats(){
        MLBDFSPlayerStatsSelectButton.removeActiveItems();
    }

    function clearMLBProjectDFSPlayers(){
        MLBProjectDFSPlayerSelectButton.removeActiveItems();
    }

    function clearMLBProjectDFSStats(){
        MLBProjectDFSPlayerStatsSelectButton.removeActiveItems();
    }

    async function MLBTeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('mlb_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('mlb_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('mlb_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){
            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("MLB", "team", team_names, date_range, date_selected)

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }

                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Team&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Team&agg=mean&barmode=group"
                }
                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function MLBPlayerCompareButton(){
        //resets instance id
        instanceId = {{user_id}}+'_'+'3';

        var player_names = [];
        for (var player of document.getElementById('mlb_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('mlb_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('mlb_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("MLB", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function MLBDFSPlayerCompareButton(){

        var player_names = [];
        for (var player of document.getElementById('mlb_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('mlb_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('mlb_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }


        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("MLB", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"


            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    //Mobile
    async function MobileMLBTeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('mlb_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('mlb_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('mlb_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){
            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            //shows chart and hides home screen
            document.getElementById('mlb_back_home_mobile').setAttribute( "onClick", "javascript: getMLBHome(1);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{
                url = url + "%29&x=Team&agg=mean&barmode=group"

                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('mlb_back_home_mobile').setAttribute( "onClick", "javascript: getMLBHome(1);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('mlb_home_1').style.display="none";
                document.getElementById('mlb_home_2').style.display="none";
                document.getElementById('mlb_mobile').style.display="none";
                document.getElementById('mlb_compare_teams').style.display="none";
                document.getElementById('mlb_compare_players').style.display="none";
                document.getElementById('mlb_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'MLBTeamCompareButton()');
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function MobileMLBPlayerCompareButton(){

        var player_names = [];
        for (var player of document.getElementById('mlb_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('mlb_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('mlb_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'3';

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"


                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="


                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{


                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('mlb_back_home_mobile').setAttribute( "onClick", "javascript: getMLBHome(2);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('mlb_home_1').style.display="none";
                document.getElementById('mlb_home_2').style.display="none";
                document.getElementById('mlb_mobile').style.display="none";
                document.getElementById('mlb_compare_teams').style.display="none";
                document.getElementById('mlb_compare_players').style.display="none";
                document.getElementById('mlb_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'MLBPlayerCompareButton()');

            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function MobileMLBDFSPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('mlb_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('mlb_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('mlb_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }


        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('mlb_back_home_mobile').setAttribute( "onClick", "javascript: getMLBHome(3);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('mlb_home_1').style.display="none";
                document.getElementById('mlb_home_2').style.display="none";
                document.getElementById('mlb_mobile').style.display="none";
                document.getElementById('mlb_compare_teams').style.display="none";
                document.getElementById('mlb_compare_players').style.display="none";
                document.getElementById('mlb_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'MLBDFSPlayerCompareButton()');
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    function MobileMLBPlayerProjectButton(){
        var player = document.getElementById("mlb_project_player_select").value;
        var stat = document.getElementById("mlb_project_player_stats_select").value;
        var games_back = document.getElementById("mlb_project_player_date_range").value;
        var split = document.getElementById("mlb_project_player_split").value;
        var prop = document.getElementById("mlb_project_player_prop").value;
        if (prop == ""){
            prop = "none";
        }
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/' + prop + '/'+ games_back + '/' + split + '/'
        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }


    }
    function MobileMLBDFSPlayerProjectButton(){
        var player = document.getElementById("mlb_project_dfs_player_select").value;
        var stat = document.getElementById("mlb_project_dfs_player_stats_select").value;
        var games_back = document.getElementById("mlb_project_dfs_player_date_range").value;
        var prop = "none"
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/none/'+ games_back + '/'

        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }
    }

    function getNHLHome(choice){
        if(choice == 0){
            document.getElementById('nhl_home_1').style.display="block";
            document.getElementById('nhl_home_2').style.display="block";
            document.getElementById('nhl_mobile').style.display="block";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 1){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="block";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 2){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="block";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
        if(choice == 3){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="block";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
            document.getElementById('spreadsheet-menu').style.display="none";
            document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";
        }
    }

    function compareNHLTeams(){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="block";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareNHLPlayers(){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="block";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function compareNHLDFSPlayers(){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="block";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectNHLPlayers(){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="block";
            document.getElementById('nhl_project_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="none";
    }

    function projectNHLDFSPlayers(){
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('nhl_project_players').style.display="none";
            document.getElementById('nhl_project_dfs_players').style.display="block";
            document.getElementById('mobile-chart').style.display="none";
    }

    function clearNHLTeams(){
        NHLTeamSelectButton.removeActiveItems();
    }

    function clearNHLTeamStats(){
        NHLTeamStatsSelectButton.removeActiveItems();
    }

    function clearNHLPlayers(){
        NHLPlayerSelectButton.removeActiveItems();
    }

    function clearNHLPlayerStats(){
        NHLPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNHLProjectPlayers(){
        NHLProjectPlayerSelectButton.removeActiveItems();
    }

    function clearNHLProjectPlayerStats(){
        NHLProjectPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNHLDFSPlayers(){
        NHLDFSPlayerSelectButton.removeActiveItems();
    }

    function clearNHLDFSStats(){
        NHLDFSPlayerStatsSelectButton.removeActiveItems();
    }

    function clearNHLProjectDFSPlayers(){
        NHLProjectDFSPlayerSelectButton.removeActiveItems();
    }

    function clearNHLProjectDFSStats(){
        NHLProjectDFSPlayerStatsSelectButton.removeActiveItems();
    }
    async function NHLTeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('nhl_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('nhl_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nhl_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){
            //resets instance id
            instanceId = {{user_id}}+'_'+'2';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NHL", "team", team_names, date_range, date_selected)

            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }

            var url = "";


            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Team&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Team&agg=mean&barmode=group"
                }

                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function NHLPlayerCompareButton(){
        //resets instance id
        instanceId = {{user_id}}+'_'+'3';

        var player_names = [];
        for (var player of document.getElementById('nhl_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nhl_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nhl_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NHL", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function NHLDFSPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nhl_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nhl_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nhl_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';

            //shows iframe and hides home screen
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";

            var pine_query = await buildQuery("NHL", "player", player_names, date_range, date_selected)

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/charts/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/charts/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                else{
                    url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="
                }
                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{
                if (pine_query != ""){
                    url = url + "%29+and+" + pine_query + "&x=Player+Name&agg=mean&barmode=group"
                }
                else{
                    url = url + "%29&x=Player+Name&agg=mean&barmode=group"
                }
                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            document.getElementById('csv_data').src = url;

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == instanceId){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    //MOBILE
    async function MobileNHLTeamCompareButton(){

        var team_names = [];
        for (var team of document.getElementById('nhl_team_select').options)
        {
            if (team.selected) {
                team_names.push(team.value.replaceAll(" ", "+"));
            }
        }

        var team_stats = [];
        for (var stat of document.getElementById('nhl_team_stats_select').options)
        {

            if (stat.selected) {
                team_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nhl_team_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((team_names.length > 0) && (team_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'2';



            var scatter = true;

            if ((team_names.length > 4) || (team_stats.length > 1)){
                scatter = false;
            }

            var url = "";

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }
            url = url + "Team+in+%28"
            for (let i = 0; i < team_names.length; i++) {
                url = url + "%27" + team_names[i] + "%27"
                if (i < team_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (team_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Team%22%5D&group_val=%5B"

                for (let i = 0; i < team_names.length; i++) {
                    url = url + "%7B%22Team%22%3A+%22" + team_names[i] + "%22%7D"
                    if (i < team_names.length-1){
                        url = url + "%2C+"
                    }
                }

            }
            else{

                url = url + "%29&x=Team&agg=mean&barmode=group"


                if (team_stats.length==1){
                    url = url + "&barsort=" + team_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < team_stats.length; i++) {
                    url = url + "%22" + team_stats[i] + "%22"
                    if (i < team_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nhl_back_home_mobile').setAttribute( "onClick", "javascript: getNHLHome(1);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nhl_home_1').style.display="none";
                document.getElementById('nhl_home_2').style.display="none";
                document.getElementById('nhl_mobile').style.display="none";
                document.getElementById('nhl_compare_teams').style.display="none";
                document.getElementById('nhl_compare_players').style.display="none";
                document.getElementById('nhl_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";
                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NHLTeamCompareButton()');
            }
        }
        else{
            if (team_names.length == 0){
                alert("Please add at least one team.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }

    }

    async function MobileNHLPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nhl_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nhl_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nhl_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'3';

            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }


            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){

                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"


                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

                for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{

                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }

            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nhl_back_home_mobile').setAttribute( "onClick", "javascript: getNHLHome(2);" );;
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nhl_home_1').style.display="none";
                document.getElementById('nhl_home_2').style.display="none";
                document.getElementById('nhl_mobile').style.display="none";
                document.getElementById('nhl_compare_teams').style.display="none";
                document.getElementById('nhl_compare_players').style.display="none";
                document.getElementById('nhl_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";

                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NHLPlayerCompareButton()');
            }
        }
       else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    async function MobileNHLDFSPlayerCompareButton(){


        var player_names = [];
        for (var player of document.getElementById('nhl_dfs_player_select').options)
        {
            if (player.selected) {
                player_names.push(player.value.replaceAll(" ", "+"));
            }
        }

        var player_stats = [];
        for (var stat of document.getElementById('nhl_dfs_player_stats_select').options)
        {

            if (stat.selected) {
                player_stats.push(stat.value.replaceAll(" ", "+"));
            }
        }

        var select = document.getElementById('nhl_dfs_player_date_range');
        var date_range = select.options[select.selectedIndex].value;

        var date_selected = true
        if (select.options[select.selectedIndex].text == "This Season"){
            date_selected = false
        }
        if (select.options[select.selectedIndex].text == "All Time"){
            date_selected = false
        }

        if ((player_names.length > 0) && (player_stats.length > 0)){

            //resets instance id
            instanceId = {{user_id}}+'_'+'4';


            var scatter = true;

            if ((player_names.length > 4) || (player_stats.length > 1)){
                scatter = false;
            }

            var url = ""

            if(scatter){
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=scatter&query="
            }
            else{
                url = url + "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query="
            }

            if (date_selected){
                url = url + "Date+%3E%3D+%27" + date_range + "%27+and+"
            }
            else if (select.options[select.selectedIndex].text == "This Season"){
                url = url + "Season+Year+%3D%3D+" + date_range + "+and+"
            }

            url = url + "Player+Name+in+%28"
            for (let i = 0; i < player_names.length; i++) {
                url = url + "%27" + player_names[i] + "%27"
                if (i < player_names.length-1){
                    url = url + "%2C+"
                }
            }

            if (scatter){
                var trendline = "lowess"
                if ((select.options[select.selectedIndex].text == "Last Week") || (select.options[select.selectedIndex].text == "Last Month"))
                    trendline = "ols"

                url = url + "%29&x=Date&agg=raw&trendline=" + trendline + "&cpg="

                if (player_names.length > 3){
                    url = url + "true"
                }
                else{
                    url = url + "false"
                }
                url = url + "&y=%5B"

                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }

                url = url + "%5D&group=%5B%22Player+Name%22%5D&group_val=%5B"

            for (let i = 0; i < player_names.length; i++) {
                    url = url + "%7B%22Player+Name%22%3A+%22" + player_names[i] + "%22%7D"
                    if (i < player_names.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            else{

                url = url + "%29&x=Player+Name&agg=mean&barmode=group"

                if (player_stats.length==1){
                    url = url + "&barsort=" + player_stats[0] + "&"
                }
                url = url + "&cpg=false&y=%5B"
                for (let i = 0; i < player_stats.length; i++) {
                    url = url + "%22" + player_stats[i] + "%22"
                    if (i < player_stats.length-1){
                        url = url + "%2C+"
                    }
                }
            }
            url = url + "%5D"

            var urlFetch = await fetch(url);
            var urlText = await urlFetch.text();

            if (urlFetch.status == 500){
                alert("Your search didn't return any results.  Please try again.")
            }
            else{

                //shows chart and hides home screen
                document.getElementById('nhl_back_home_mobile').setAttribute( "onClick", "javascript: getNHLHome(3);" );
                document.getElementById('mobile-chart-embed').innerHTML = '';
                document.getElementById('nhl_home_1').style.display="none";
                document.getElementById('nhl_home_2').style.display="none";
                document.getElementById('nhl_mobile').style.display="none";
                document.getElementById('nhl_compare_teams').style.display="none";
                document.getElementById('nhl_compare_players').style.display="none";
                document.getElementById('nhl_compare_dfs_players').style.display="none";
                document.getElementById('mobile-chart').style.display="block";
                var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
                var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

                document.getElementById('save-mobile').href = save_url
                document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
                document.getElementById('camera-mobile').href = camera_url
                document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
                document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
                document.getElementById('dig-in-link').setAttribute( "onClick", 'NHLDFSPlayerCompareButton()');

            }
        }
        else{
            if (player_names.length == 0){
                alert("Please add at least one player.");
            }
            else{
                alert("Please add at least one stat.");
            }
        }
    }

    function MobileNHLPlayerProjectButton(){
        var player = document.getElementById("nhl_project_player_select").value;
        var stat = document.getElementById("nhl_project_player_stats_select").value;
        var games_back = document.getElementById("nhl_project_player_date_range").value;
        var split = document.getElementById("nhl_project_player_split").value;
        var prop = document.getElementById("nhl_project_player_prop").value;
        if (prop == ""){
            prop = "none";
        }
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/' + prop + '/'+ games_back + '/' + split + '/'
        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }
    }

    function MobileNHLDFSPlayerProjectButton(){
        var player = document.getElementById("nhl_project_dfs_player_select").value;
        var stat = document.getElementById("nhl_project_dfs_player_stats_select").value;
        var games_back = document.getElementById("nhl_project_dfs_player_date_range").value;
        var prop = "none"
        var url = '/stats/project/{{sport_name}}/' + player + '/' + stat + '/none/'+ games_back + '/'

        if (player == ""){
            alert("Please add a player")
        }
        else if (stat == ""){
            alert("Please add a stat")
        }
        else{
            window.open(url,"popup","width=810,height=1070");
        }
    }

    //Changes instanceID upon selection of new spreadsheet from dropdown
    function changeInstanceId(sel){
        var e = document.getElementById("select_dataset_id");
        var get_data_id = e.options[e.selectedIndex].value;
        instanceId = get_data_id
        if(instanceId == 0){
            //resets instance id
            instanceId = {{user_id}}+'_'+'1';

            //resets iframe
            document.getElementById('csv_data').src = ""

            //hides iframe and shows home screen
            document.getElementById('pine-container').style.display="block";
            document.getElementById('explore-home').style.display="block";
            document.getElementById('dtale-iframe').style.display="none";

            var ddl = document.getElementById('select_dataset_id');
            var opts = ddl.options.length;
            for (var i=0; i<opts; i++){
                if (ddl.options[i].value == "0"){
                    ddl.options[i].selected = true;
                    break;
                }
            }
        }
        else
        {
            document.getElementById('pine-container').style.display="flex";
            document.getElementById('explore-home').style.display="none";
            document.getElementById('dtale-iframe').style.display="flex";
            document.getElementById('spreadsheet-menu').style.display="flex";
            document.getElementById('sticky-wrapper').style.backgroundColor="#white";
            document.getElementById('csv_data').src ="/dtale/main/"+instanceId;
        }

    }

    async function checkFlags(){
        checkInstanceId = instanceId;

        chart_number = checkInstanceId.split("_")[1]

        var elms = document.querySelectorAll("[class='flag_on_2']");
        for(var i = 0; i < elms.length; i++)
          elms[i].style.display="none";

        var elms = document.querySelectorAll("[class='flag_on_3']");
        for(var i = 0; i < elms.length; i++)
          elms[i].style.display="none";

        var elms = document.querySelectorAll("[class='flag_on_4']");
        for(var i = 0; i < elms.length; i++)
          elms[i].style.display="none";


        if(chart_number == 2){
            var reset_url = '/dtale/save-column-filter/' + checkInstanceId + '/Team?cfg={"type":"string","value":[],"operand":"="}'
            var reset_response = await fetch(reset_url);
        }

        else{
            var reset_url = '/dtale/save-column-filter/' + checkInstanceId + '/Player Name?cfg={"type":"string","value":[],"operand":"="}'
            var reset_response = await fetch(reset_url);
        }

        reset_url = '/dtale/save-column-filter/' + checkInstanceId +'/Date?cfg={"type":"date","start":null,"end":null}';
        var reset_response2 = await fetch(reset_url);

        {% if sport_name == "MLB" %}
        reset_url = '/dtale/save-column-filter/' + checkInstanceId + '/Season?cfg={"type":"int","operand":"=","value":[]}';
        var reset_response3 = await fetch(reset_url);
        {% else %}
        reset_url = '/dtale/save-column-filter/' + checkInstanceId + '/Season Year?cfg={"type":"int","operand":"=","value":[]}';
        var reset_response3 = await fetch(reset_url);
        {% endif %}


        var save_url = '/dtale/column-analysis/' + checkInstanceId
        var queryFetch = await fetch(save_url);
        var queryJson = await queryFetch.text();
        var queryInfo = JSON.parse(queryJson);
        var pine_query = queryInfo.query;

        if(chart_number == 2){
            if(pine_query == ""){
                var elms = document.querySelectorAll("[class='flag_on_2']");
                for(var i = 0; i < elms.length; i++)
                  elms[i].style.display="none";
            }
            else{
                var elms = document.querySelectorAll("[class='flag_on_2']");
                for(var i = 0; i < elms.length; i++)
                  elms[i].style.display="block";
            }
        }

        if(chart_number == 3){
            if(pine_query == ""){
                var elms = document.querySelectorAll("[class='flag_on_3']");
                for(var i = 0; i < elms.length; i++)
                  elms[i].style.display="none";
            }
            else{
                var elms = document.querySelectorAll("[class='flag_on_3']");
                for(var i = 0; i < elms.length; i++)
                  elms[i].style.display="block";
            }
        }

        if(chart_number == 4){
            if(pine_query == ""){
                var elms = document.querySelectorAll("[class='flag_on_4']");
                for(var i = 0; i < elms.length; i++)
                  elms[i].style.display="none";
            }
            else{
                var elms = document.querySelectorAll("[class='flag_on_4']");
                for(var i = 0; i < elms.length; i++)
                  elms[i].style.display="block";
            }
        }

    }

    //Goes to home page when user clicks on home button
    function getHome(){

        checkFlags();

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //resets iframe
        document.getElementById('csv_data').src = ""

        //hides iframe and shows home screen
        document.getElementById('pine-container').style.display="block";
        document.getElementById('explore-home').style.display="block";
        document.getElementById('dtale-iframe').style.display="none";
        document.getElementById('spreadsheet-menu').style.display="none";
        document.getElementById('sticky-wrapper').style.backgroundColor="#F5F7FA";

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == "0"){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function getGameStats(){
        {% if is_group %}
        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        ps = document.getElementsByName("game-stats")

        var isReady = "Failure"
        while (isReady == "Failure"){

            for (var x=0; x < ps.length; x++){
                ps[x].classList.add('generating-css')
            }

            ready_url = "/check_instance/" + instanceId
            var ready = await fetch(ready_url)
            var readyJson = await ready.text();
            isReady = JSON.parse(readyJson);

            console.log(isReady)
        }

        for (var x=0; x < ps.length; x++){
            ps[x].classList.remove('generating-css')
        }

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
        {% endif %}
    }

    function NBAgetLatestScores(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Visitor+-+Score%22%2C+%22Home+-+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NBAgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Point+Spread%22%2C+%22Final+Score+Spread%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileNBAgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Point+Spread%22%2C+%22Final+Score+Spread%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
            var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
            var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

            //shows chart and hides home screen
            document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'NBAgetLatestSpreadsAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NBAgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Over-Under%22%2C+%22Total+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileNBAgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Over-Under%22%2C+%22Total+Score%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
        var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
           //shows chart and hides home screen
            document.getElementById('nba_back_home_mobile').setAttribute( "onClick", "javascript: getNBAHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nba_home_1').style.display="none";
            document.getElementById('nba_home_2').style.display="none";
            document.getElementById('nba_mobile').style.display="none";
            document.getElementById('nba_compare_teams').style.display="none";
            document.getElementById('nba_compare_players').style.display="none";
            document.getElementById('nba_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'NBAgetLatestOUAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NFLgetLatestScores(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Week%3D%3D" + lastNFLWeek + "+and+Season+Year%3D%3D{{this_season}}&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Visitor+-+Score%22%2C+%22Home+-+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NFLgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Week%3D%3D" + lastNFLWeek + "+and+Season+Year%3D%3D{{this_season}}&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Spread%22%2C+%22Final+Score+Spread%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileNFLgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';


        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Week%3D%3D" + lastNFLWeek + "+and+Season+Year%3D%3D{{this_season}}&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Spread%22%2C+%22Final+Score+Spread%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
            var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
            var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

            //shows chart and hides home screen
            document.getElementById('nfl_back_home_mobile').setAttribute( "onClick", "javascript: getNFLHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'NFLgetLatestSpreadsAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }


    function NFLgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Week%3D%3D" + lastNFLWeek + "+and+Season+Year%3D%3D{{this_season}}&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Over-Under%22%2C+%22Total+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileNFLgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Week%3D%3D" + lastNFLWeek + "+and+Season+Year%3D%3D{{this_season}}&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Over-Under%22%2C+%22Total+Score%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
        var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
           //shows chart and hides home screen
            document.getElementById('nfl_back_home_mobile').setAttribute( "onClick", "javascript: getNFLHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nfl_home_1').style.display="none";
            document.getElementById('nfl_home_2').style.display="none";
            document.getElementById('nfl_mobile').style.display="none";
            document.getElementById('nfl_compare_teams').style.display="none";
            document.getElementById('nfl_compare_players').style.display="none";
            document.getElementById('nfl_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'NFLgetLatestOUAndResults()');
        }
        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function MLBgetLatestScores(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Visitor+-+Runs%22%2C+%22Home+-+Runs%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function MLBgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Point+Spread%22%2C+%22Final+Score+Spread%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileMLBgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Point+Spread%22%2C+%22Final+Score+Spread%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
            var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
            var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

            //shows chart and hides home screen
            document.getElementById('mlb_back_home_mobile').setAttribute( "onClick", "javascript: getMLBHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'MLBgetLatestSpreadsAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function MLBgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Over-Under%22%2C+%22Total+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileMLBgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Over-Under%22%2C+%22Total+Score%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
        var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
           //shows chart and hides home screen
            document.getElementById('mlb_back_home_mobile').setAttribute( "onClick", "javascript: getMLBHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('mlb_home_1').style.display="none";
            document.getElementById('mlb_home_2').style.display="none";
            document.getElementById('mlb_mobile').style.display="none";
            document.getElementById('mlb_compare_teams').style.display="none";
            document.getElementById('mlb_compare_players').style.display="none";
            document.getElementById('mlb_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'MLBgetLatestOUAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NHLgetLatestScores(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Visitor+-+Final+Score%22%2C+%22Home+-+Final+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NHLgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Spread%22%2C+%22Final+Score+Spread%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileNHLgetLatestSpreadsAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Spread%22%2C+%22Final+Score+Spread%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
            var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
            var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

            //shows chart and hides home screen
            document.getElementById('nhl_back_home_mobile').setAttribute( "onClick", "javascript: getNHLHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'NHLgetLatestSpreadsAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    function NHLgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        url = "/charts/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Over-Under%22%2C+%22Total+Score%22%5D";

        document.getElementById('csv_data').src = url;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function mobileNHLgetLatestOUAndResults(){

        //resets instance id
        instanceId = {{user_id}}+'_'+'1';

        url = "/mobile_chart/{{sport_name}}/" + instanceId + "?chart_type=bar&query=Date%3D%3D%27" + lastDate + "%27&x=Game+Name&agg=raw&barmode=group&cpg=false&y=%5B%22Closing+Over-Under%22%2C+%22Total+Score%22%5D";

        var urlFetch = await fetch(url);
        var urlText = await urlFetch.text();

        var camera_url = url.replace("mobile_chart/{{sport_name}}", "dtale/chart-export") + "&export_type=png"
        var save_url = url.replace("mobile_chart/{{sport_name}}", "file_send_server")

        if (urlFetch.status == 500){
            alert("Your search didn't return any results.  Please try again.")
        }
        else{
           //shows chart and hides home screen
            document.getElementById('nhl_back_home_mobile').setAttribute( "onClick", "javascript: getNHLHome(0);" );
            document.getElementById('mobile-chart-embed').innerHTML = '';
            document.getElementById('nhl_home_1').style.display="none";
            document.getElementById('nhl_home_2').style.display="none";
            document.getElementById('nhl_mobile').style.display="none";
            document.getElementById('nhl_compare_teams').style.display="none";
            document.getElementById('nhl_compare_players').style.display="none";
            document.getElementById('nhl_compare_dfs_players').style.display="none";
            document.getElementById('mobile-chart').style.display="block";

            document.getElementById('save-mobile').href = save_url
            document.getElementById('save-mobile').setAttribute( "onClick", "javascript: window.open('" + save_url + "','popup'); return false;" );
            document.getElementById('camera-mobile').href = camera_url
            document.getElementById('camera-mobile').setAttribute( "onClick", "javascript: window.open('" + camera_url + "','popup'); return false;" );
            document.getElementById('mobile-chart-embed').innerHTML = '<embed src="{{CHARTS_URL}}{{user_id}}/mobile_chart.html#refresh={% random_int 1 10 %}" height="100%" width="100%">'
            document.getElementById('dig-in-link').setAttribute( "onClick", 'NHLgetLatestOUAndResults()');
        }

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    async function getTeamStats(){
        {% if is_group %}
        //resets instance id
        instanceId = {{user_id}}+'_'+'2';

        var isReady = "Failure"

        ps = document.getElementsByName("team-stats")

        while (isReady == "Failure"){

            for (var x=0; x < ps.length; x++){
                ps[x].classList.add('generating-css')
            }

            ready_url = "/check_instance/" + instanceId
            var ready = await fetch(ready_url)
            var readyJson = await ready.text();
            isReady = JSON.parse(readyJson);

            console.log(isReady)
        }

        for (var x=0; x < ps.length; x++){
            ps[x].classList.remove('generating-css')
        }

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
        {% endif %}
    }

    async function getPlayerStats(){
        {% if is_group %}
        //resets instance id
        instanceId = {{user_id}}+'_'+'3';

        var isReady = "Failure"

        ps = document.getElementsByName("player-stats")

        while (isReady == "Failure"){

            for (var x=0; x < ps.length; x++){
                ps[x].classList.add('generating-css')
            }

            ready_url = "/check_instance/" + instanceId
            var ready = await fetch(ready_url)
            var readyJson = await ready.text();
            isReady = JSON.parse(readyJson);

            console.log(isReady)
        }

        for (var x=0; x < ps.length; x++){
            ps[x].classList.remove('generating-css')
        }

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
        {% endif %}
    }

    async function getDailyFantasyStats(){
        {% if is_group %}
        //resets instance id
        instanceId = {{user_id}}+'_'+'4';

        ps = document.getElementsByName("fantasy-stats")

        var isReady = "Failure"

        while (isReady == "Failure"){

            for (var x=0; x < ps.length; x++){
                ps[x].classList.add('generating-css')
            }

            ready_url = "/check_instance/" + instanceId
            var ready = await fetch(ready_url)
            var readyJson = await ready.text();
            isReady = JSON.parse(readyJson);

            console.log(isReady)
        }

        for (var x=0; x < ps.length; x++){
            ps[x].classList.remove('generating-css')
        }

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";

        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
        {% endif %}
    }


    //Goes to dtale spreadsheet when user clicks on view
    function getView(){
        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    //Goes to charts when user clicks on visualize
    function getCharts(){

        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        document.getElementById('csv_data').src ="/charts/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    //Goes to correlations when user clicks on correlations
    function getCorrelations(){
        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        document.getElementById('csv_data').src ="/dtale/popup/correlations/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

    //Goes to describe when user clicks on select
    function getSelect(){
        //shows iframe and hides home screen
        document.getElementById('pine-container').style.display="flex";
        document.getElementById('explore-home').style.display="none";
        document.getElementById('dtale-iframe').style.display="flex";
        document.getElementById('spreadsheet-menu').style.display="flex";
        document.getElementById('sticky-wrapper').style.backgroundColor="#white";
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;

        document.getElementById('csv_data').src ="/dtale/popup/describe/"+instanceId;

        var ddl = document.getElementById('select_dataset_id');
        var opts = ddl.options.length;
        for (var i=0; i<opts; i++){
            if (ddl.options[i].value == instanceId){
                ddl.options[i].selected = true;
                break;
            }
        }
    }

</script>
<!-- BEGIN VENDOR JS-->
<script src="{% static 'app-assets/vendors/js/vendors.min.js' %}" type="text/javascript"></script>
<script type="text/javascript" src="{% static 'app-assets/vendors/js/ui/jquery.sticky.js' %}"></script>
<script src="{% static 'app-assets/js/core/app-menu.min.js' %}" type="text/javascript"></script>
<script src="{% static 'app-assets/js/core/app.min.js' %}" type="text/javascript"></script>

</body>
</html>
