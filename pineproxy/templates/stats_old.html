{% load static %}
<!DOCTYPE html>
<html lang="en" data-textdirection="ltr" class="loading">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>-->
    <!-- <link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i%7COpen+Sans:300,300i,400,400i,600,600i,700,700i" rel="stylesheet">-->
    <!-- BEGIN VENDOR CSS-->
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/feather/style.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/bootstrap-extended.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/app.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/colors.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/core/menu/menu-types/horizontal-menu.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}">

    <!-- START Custom CSS-->
    <!-- END Custom CSS-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MVXEN40PGH"></script>

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-MVXEN40PGH');
    </script>

</head>

<style>
    body, html {width: 100%; height: 100%; margin: 0; padding: 0}

    .dtale-link{
        font-size:16px !important;
        color: #black!important;
        font-family: 'Roboto' !important
    }

    .dtale-link-selected{
        font-size:18px !important;
        color:#4EC48F !important
        font-family: 'Roboto' !important
    }
    .dtale-link:hover{
        color:#4EC48F !important
    }

    .dtale-link-icon{
        margin-right:10px;
        width:30px
    }

    /* Flex options allow for iFrame to auto adjust to browswer window.
    Pine container includes sticky container and dtale iframe container
    Sticky container is fixed
    Dtale iframe container is flex-grow */

    .pine-container{
        display: flex; width: 100%; height: 100%; flex-direction: column; background-color: blue;
    }

    .sticky-container{
        background-color: white !important;
    }

    .dtale-iframe{
        background-color: white !important;
        background: url("{% static 'images/Spin1_Gray.svg' %}") center center no-repeat;
        flex-grow: 1; border: none; margin: 0; padding: 0;
        min-height:500px
    }
    .holds-the-iframe {
    background: url("{% static 'images/Spin1_Gray.svg' %}") center center no-repeat;
    }


</style>

<body data-open="click" data-menu="horizontal-menu" data-col="2-columns" class="horizontal-layout horizontal-menu 2-columns">
<!-- navbar-fixed-top-->
<div class=" hidden-sm-down pine-container">
    <div class="sticky-container">
        <nav class="header-navbar navbar navbar-with-menu navbar-static-top navbar-light navbar-border navbar-brand-center navbar-fixed top-navb" style="height:75px!important; background-color:#efbfcfd">
            <div class="navbar-wrapper  container-fluid">
                <div class="navbar-header">
                    <ul class="nav navbar-nav">
                        <li class="nav-item mobile-menu hidden-md-up float-xs-left"><a href="#" class="nav-link nav-menu-main menu-toggle hidden-xs"><i class="font-large-1"></i></a></li>
                        <li class="nav-item">

                            {% if user.is_authenticated %}
                            <a href="/" class="navbar-brand" style="left:60px; padding-top:6px"><img alt="Pine" src="{% static 'images/PineSportsLogo.svg' %}" style="height:60px; width:100%;" class="brand-logo">  </a>
                            {% else %}
                            <a href="/" class="navbar-brand" style="left:60px; padding-top:6px"><img alt="Pine" src="{% static 'images/PineSportsLogo.svg' %}" style="height:60px; width:100%;" class="brand-logo">  </a>
                            {% endif %}

                        </li>
                        <li class="nav-item hidden-md-up float-xs-right"><a data-toggle="collapse" data-target="#navbar-mobile" class="nav-link open-navbar-container"><i class="fa ft-menu" style="padding-top: 11px"></i></a></li>
                    </ul>
                </div>
                <div class="navbar-container  center-layout">
                    <div id="navbar-mobile" class="collapse navbar-toggleable-sm">
                        {% if user.is_authenticated %}
                        <ul class="nav navbar-nav float-xs-right admin">

                            <li class="dropdown dropdown-notification nav-item"><a href="/"><img src="{% static 'images/black-home-feed.svg'%}" title="Home" class="img-responsive mr-1 mt-1" ></img></a></li>
                            <li class="dropdown dropdown-notification nav-item"><a href="{% url 'stories:post-create' %}"><img src="{% static 'images/black-write-circle.svg'%}" style="margin-right:30px" title="New Post" class="img-responsive mr-1 mt-1" ></img></a></li>
                            <li class="dropdown dropdown-user nav-item"><a href="/user/{{user}}" data-toggle="dropdown" class="dropdown-toggle nav-link dropdown-user-link"><span class="avatar avatar-online"><img src="{{ request.user.profile.image_url }}?v=2" onError='this.onerror=null;this.src="{% static "images/profile.svg" %}?v=2";' alt="avatar" style="width:60px" alt="avatar"><i></i></span><span class="user-name">{{user}}</span></a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="/user/{{user}}"><img class="d-icon" src="{% static 'images/black-my-stories.svg'%}">  My Stories</a>

                                    <a class="dropdown-item" href="{% url 'settings' %}"><img class="d-icon" src="{% static 'images/black-settings.svg'%}">  Settings</a>
                                    <a class="dropdown-item" href="{% url 'help' %}"><img class="d-icon" src="{% static 'images/black-help.svg'%}">  Help</a>


                                    <a class="dropdown-item" href="/logout/"><img class="d-icon" src="{% static 'images/black-logout.svg'%}">  Logout</a>
                                </div>
                            </li>
                        </ul>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% if user.is_authenticated %}
            <!-- Horizontal navigation-->
            <div role="navigation" data-menu="menu-wrapper" class="header-navbar navbar navbar-horizontal navbar-fixed navbar-light navbar-without-dd-arrow navbar-shadow menu-border">
                <!-- Horizontal menu content-->
                <div data-menu="menu-container" class="navbar-container main-menu-content container-fluid center-layout">
                    <!-- include includes/mixins-->
                    <ul id="main-menu-navigation" data-menu="menu-navigation" class="nav navbar-nav">
                        <!--Added this so that Stories lines up with Pine logo -->
                        <li>     </li>
                        <li data-menu="dropdown" class="dropdown nav-item">
                            <a href="{% url 'stories:blog-home' %}" class="nav-link" style="font-family: 'Raleway'; font-size: 25px">Stories</a>
                        </li>
                        {% if is_group %}
                        <li data-menu="dropdown" class="dropdown nav-item active">
                            <a class="nav-link" href="{% url 'stats' %}" style="font-family: 'Raleway'; font-weight: 500; font-size: 25px">Explore</a>
                        </li>
                        {% else %}
                        <span></span>
                        {% endif %}
                    </ul>

                </div>
                <!-- /horizontal menu content-->
            </div>
            <!-- Horizontal navigation-->

            <!-- Spreadsheet Menu-->
            <div data-menu="menu-container" class="navbar-container main-menu-content container-fluid center-layout" style="min-width:767px!important">
                <div class="row">
                    <div class="col-xs-1" style="max-width:10px"></div>
                    <div class="col-xs-1" style="margin-top:5px; min-width:120px; max-width:120px">
                        <a onclick="getView()" class="nav-link dtale-link" id="View" ><img src="{% static 'images/view.svg'%}?v=1" class="dtale-link-icon" title="View" class="img-responsive">View</a>
                    </div>
                    <div class="col-xs-1" style="margin-top:5px; min-width:140px; max-width:140px">
                        <a onclick="getCharts()" class="nav-link dtale-link" id="Vizualize"><img src="{% static 'images/visualize.svg'%}?v=1" class="dtale-link-icon" title="Vizualize" class="img-responsive">Visualize</a>
                    </div>
                    <div class="col-xs-1" style="margin-top:5px; min-width:140px; max-width:140px">
                        <a onclick="getCorrelations()" class="nav-link dtale-link" id="Correlate"><img src="{% static 'images/correlate.svg'%}?v=1" class="dtale-link-icon" title="Correlate" class="img-responsive">Correlate</a>
                    </div>
                    <div class="col-xs-1" style="margin-top:5px; min-width:115px; max-width:140px">
                        <a onclick="getSelect()" class="nav-link dtale-link" id="Select"><img src="{% static 'images/select.svg'%}?v=1" class="dtale-link-icon" title="Select" class="img-responsive">Select</a>
                    </div>
                    <!--- <div class="col-xs-1" style="margin-top:5px; min-width:115px; max-width:140px">
                        <a id="save_id" href="/" class="nav-link dtale-link" id="Select">Save</a>
                    </div> -->
                    <div class="pull-right" style="margin-top:1px; margin-right:10px">
                        <ul data-menu="menu-navigation" class="nav navbar-nav">
                            <li data-menu="dropdown" class="dropdown nav-item">
                                <SELECT NAME="options" class="form-control form-control-sm" style="margin:7px" id="select_dataset_id" ONCHANGE="changeInstanceId(this)">
                                    {% for data_id,name in data_id_and_names.items %}
                                    <option value={{data_id}} class="iframe_button">
                                        {{name}}
                                    </option>
                                    {% endfor %}                                    
                                </SELECT>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            {% endif %}
        </nav>
        <div style="margin-top: 83px"></div>
    </div>

    <div class="dtale-iframe" style="margin-top: 0px !important">
        <iframe src=" " width="100%" height="100%" title="Iframe Example" id="csv_data">
        </iframe>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

<script>
    var instanceId = {{user_id}}+'_'+'1'; //This should be the user's initial instanceID, place initial instanceid Django variable here.

    //Loads initial spreadsheet on start
    window.onload = function(){
        setTimeout(function(){
            document.getElementById('csv_data').src ="/dtale/main/"+instanceId;
        });
    };

    //Changes instanceID upon selection of new spreadsheet from dropdown
    function changeInstanceId(sel){
        var e = document.getElementById("select_dataset_id");
        var get_data_id = e.options[e.selectedIndex].value;
        instanceId = get_data_id
        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;
    }

    //Goes to dtale spreadsheet when user clicks on view
    function getView(){

        document.getElementById('csv_data').src ="/dtale/main/"+instanceId;
    }

    //Goes to charts when user clicks on visualize
    function getCharts(){

        document.getElementById('csv_data').src ="/charts/"+instanceId;
    }

    //Goes to correlations when user clicks on correlations
    function getCorrelations(){

        document.getElementById('csv_data').src ="/dtale/popup/correlations/"+instanceId;
    }

    //Goes to describe when user clicks on select
    function getSelect(){

        document.getElementById('csv_data').src ="/dtale/popup/describe/"+instanceId;
    }
</script>
<!-- BEGIN VENDOR JS-->
<script src="{% static 'app-assets/vendors/js/vendors.min.js' %}" type="text/javascript"></script>
<script type="text/javascript" src="{% static 'app-assets/vendors/js/ui/jquery.sticky.js' %}"></script>
<script src="{% static 'app-assets/js/core/app-menu.min.js' %}" type="text/javascript"></script>
<script src="{% static 'app-assets/js/core/app.min.js' %}" type="text/javascript"></script>

</body>
</html>